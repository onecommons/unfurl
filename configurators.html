<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Configurators &mdash; Unfurl Documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" type="text/css" />
      <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="_static/favicon32.png"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/design-tabs.js"></script>
        <script src="_static/custom.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Template Processing" href="processing.html" />
    <link rel="prev" title="Runtime Environment" href="runtime.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/unfurl_logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="solution-overview.html">Solution Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="projects.html">Unfurl Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="ensembles.html">Ensembles</a></li>
<li class="toctree-l1"><a class="reference internal" href="jobs.html">Jobs and Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="tosca.html">TOSCA</a></li>
<li class="toctree-l1"><a class="reference internal" href="dsl.html">TOSCA as Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="toscaref.html">TOSCA Language Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="packages.html">Repositories and Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="secrets.html">Managing Secrets</a></li>
<li class="toctree-l1"><a class="reference internal" href="runtime.html">Runtime Environment</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Configurators</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#ansible">Ansible</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inputs">Inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#outputs">Outputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implementation-key-notes"><code class="docutils literal notranslate"><span class="pre">implementation</span></code> key notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#playbook-processing">Playbook processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inventory">Inventory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#execution-environment">Execution environment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#cmd">Cmd</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#delegate">Delegate</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">Inputs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#shell">Shell</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#inline-shell-script-example">Inline shell script example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-with-artifact">Example with artifact</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">Inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#result-template-variables">Result template variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">Outputs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#template">Template</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id6">Inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">Outputs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#terraform">Terraform</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id9">Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">Inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">Outputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tfvar-and-tfoutput-metadata"><code class="docutils literal notranslate"><span class="pre">tfvar</span></code> and <code class="docutils literal notranslate"><span class="pre">tfoutput</span></code> Metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="#environment-variables">Environment Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#note-on-hcl-in-yaml">Note on HCL in YAML</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#installers">Installers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#docker">Docker</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#unfurl-nodes-container-application-docker">unfurl.nodes.Container.Application.Docker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#artifacts">artifacts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id13">Inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id14">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#dns">DNS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#unfurl-nodes-dnszone">unfurl.nodes.DNSZone</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#properties">Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#unfurl-relationships-dnsrecords">unfurl.relationships.DNSRecords</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id15">Properties</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id16">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#helm">Helm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#unfurl-nodes-helmrelease">unfurl.nodes.HelmRelease</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id18">Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id19">Inputs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#unfurl-nodes-helmrepository">unfurl.nodes.HelmRepository</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id20">Properties</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#kubernetes">Kubernetes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#unfurl-nodes-k8scluster">unfurl.nodes.K8sCluster</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id22">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#unfurl-nodes-k8snamespace">unfurl.nodes.K8sNamespace</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id23">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id24">Properties</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#unfurl-nodes-k8sresource">unfurl.nodes.K8sResource</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id25">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id26">Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id27">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#unfurl-nodes-k8ssecretresource">unfurl.nodes.K8sSecretResource</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id28">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id29">Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id30">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#unfurl-nodes-k8srawresource">unfurl.nodes.K8sRawResource</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id31">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id32">Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id33">Attributes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#supervisor">Supervisor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#unfurl-nodes-supervisor">unfurl.nodes.Supervisor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id35">properties</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#unfurl-nodes-processcontroller-supervisor">unfurl.nodes.ProcessController.Supervisor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sup-requirements">requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id37">properties</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#id38">Artifacts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#arguments">Arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#shared-properties">Shared Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="#abstract-artifacts">Abstract artifacts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="processing.html">Template Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="expressions.html">Expression Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="cloudmap.html">Cloud Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line</a></li>
<li class="toctree-l1"><a class="reference internal" href="jsonschema.html">Configuration Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">Changelog for Unfurl</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Unfurl</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Configurators</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/configurators.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="configurators">
<h1>Configurators<a class="headerlink" href="#configurators" title="Permalink to this headline"></a></h1>
<p>Configurators is a software plugin that implements an operation and applies changes to instances. There are built-in configurators for shell scripts, Ansible playbooks, Terraform configurations, and Kubernetes resources or you can include your own as part of your blueprint.</p>
<p>To use a configurator, set it in the <code class="docutils literal notranslate"><span class="pre">implementation</span></code> field of an <a class="reference internal" href="glossary.html#operation"><span class="std std-ref">Operation</span></a>
and set its inputs as documented below. Configurator names are case-sensitive;
if a configurator name isn’t found it is treated as an external command.</p>
<p>If you set an external command line directly as the <code class="docutils literal notranslate"><span class="pre">implementation</span></code>, Unfurl will choose the appropriate one to use.
If <code class="docutils literal notranslate"><span class="pre">operation_host</span></code> is local it will use the <a class="reference internal" href="#shell"><span class="std std-ref">Shell</span></a> configurator, if it is remote,
it will use the <code class="docutils literal notranslate"><span class="pre">Ansible</span></code> configurator and generate a playbook that invokes it on the remote machine:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-YAML" for="sd-tab-item-0">
YAML</label><div class="sd-tab-content docutils">
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ensemble</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">service_template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">topology_template</span><span class="p">:</span>
<span class="w">      </span><span class="nt">node_templates</span><span class="p">:</span>
<span class="w">        </span><span class="nt">test_remote</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca:Root</span>
<span class="w">          </span><span class="nt">interfaces</span><span class="p">:</span>
<span class="w">            </span><span class="nt">Standard</span><span class="p">:</span>
<span class="w">              </span><span class="nt">configure</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">echo &quot;abbreviated configuration&quot;</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-python" for="sd-tab-item-1">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@operation</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;configure&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_remote_configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">unfurl</span><span class="o">.</span><span class="n">configurators</span><span class="o">.</span><span class="n">shell</span><span class="o">.</span><span class="n">ShellConfigurator</span><span class="p">(</span>
        <span class="n">command</span><span class="o">=</span><span class="s1">&#39;echo &quot;abbreviated configuration&quot;&#39;</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">test_remote</span> <span class="o">=</span> <span class="n">tosca</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Root</span><span class="p">()</span>
<span class="n">test_remote</span><span class="o">.</span><span class="n">set_operation</span><span class="p">(</span><span class="n">test_remote_configure</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Configurators are fairly low-level. You can use “Installer” nodes that. Artifacts</p>
<p>Available configurators include:</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#ansible" id="id39">Ansible</a></p></li>
<li><p><a class="reference internal" href="#cmd" id="id40">Cmd</a></p></li>
<li><p><a class="reference internal" href="#delegate" id="id41">Delegate</a></p></li>
<li><p><a class="reference internal" href="#shell" id="id42">Shell</a></p></li>
<li><p><a class="reference internal" href="#template" id="id43">Template</a></p></li>
<li><p><a class="reference internal" href="#terraform" id="id44">Terraform</a></p></li>
</ul>
</div>
<section id="ansible">
<span id="id1"></span><h2><a class="toc-backref" href="#id39">Ansible</a><a class="headerlink" href="#ansible" title="Permalink to this headline"></a></h2>
<p>The Ansible configurator executes the given playbook. You can access the same Unfurl filters and queries available in the Ensemble manifest from inside a playbook.</p>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline"></a></h3>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-2" name="sd-tab-set-1" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-YAML" for="sd-tab-item-2">
YAML</label><div class="sd-tab-content docutils">
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ensemble</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">service_template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">topology_template</span><span class="p">:</span>
<span class="w">      </span><span class="nt">node_templates</span><span class="p">:</span>
<span class="w">        </span><span class="nt">test_remote</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca:Root</span>
<span class="w">          </span><span class="nt">interfaces</span><span class="p">:</span>
<span class="w">            </span><span class="nt">Standard</span><span class="p">:</span>
<span class="w">              </span><span class="nt">configure</span><span class="p">:</span>
<span class="w">                </span><span class="nt">implementation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ansible</span>
<span class="w">                </span><span class="nt">inputs</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">playbook</span><span class="p">:</span>
<span class="w">                    </span><span class="c1"># quote this yaml so its templates are not evaluated before we pass it to Ansible</span>
<span class="w">                    </span><span class="nt">q</span><span class="p">:</span>
<span class="w">                      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">set_fact</span><span class="p">:</span>
<span class="w">                          </span><span class="nt">fact1</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">&#39;.name&#39;</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">eval</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">                      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Hello</span>
<span class="w">                        </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">echo &quot;{{ fact1 }}&quot;</span>
<span class="w">                </span><span class="nt">outputs</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">fact1</span><span class="p">:</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-3" name="sd-tab-set-1" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-python" for="sd-tab-item-3">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@operation</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;configure&quot;</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fact1&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">})</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_remote_configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">unfurl</span><span class="o">.</span><span class="n">configurators</span><span class="o">.</span><span class="n">ansible</span><span class="o">.</span><span class="n">AnsibleConfigurator</span><span class="p">(</span>
        <span class="n">playbook</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        - set_fact:</span>
<span class="s2">            fact1: &quot;{{ &#39;.name&#39; | eval }}&quot;</span>
<span class="s2">        - name: Hello</span>
<span class="s2">          command: echo &quot;{{ fact1 }}&quot;</span>
<span class="s2">        &quot;&quot;&quot;</span>
    <span class="p">)</span>

<span class="n">test_remote</span> <span class="o">=</span> <span class="n">tosca</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Root</span><span class="p">()</span>
<span class="n">test_remote</span><span class="o">.</span><span class="n">set_operation</span><span class="p">(</span><span class="n">test_remote_configure</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="inputs">
<h3>Inputs<a class="headerlink" href="#inputs" title="Permalink to this headline"></a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">playbook</dt>
<dd class="field-odd"><p>(<em>required</em>) If string, treat as a file path to the Ansible playbook to run, otherwise treat as an inline playbook</p>
</dd>
<dt class="field-even">inventory</dt>
<dd class="field-even"><p>If string, treat as a file path to an Ansible inventory file or directory, otherwise treat as in inline YAML inventory.
If omitted, the inventory will be generated (see below)</p>
</dd>
<dt class="field-odd">arguments</dt>
<dd class="field-odd"><p>A dictionary of variables that will be passed to the playbook as Ansible facts. See <a class="reference internal" href="#arguments"><span class="std std-ref">Arguments</span></a></p>
</dd>
<dt class="field-even">playbookArgs</dt>
<dd class="field-even"><p>A list of strings that will be passed to <code class="docutils literal notranslate"><span class="pre">ansible-playbook</span></code> as command-line arguments</p>
</dd>
<dt class="field-odd">resultTemplate</dt>
<dd class="field-odd"><p>Same behavior as defined for <a class="reference internal" href="#shell"><span class="std std-ref">Shell</span></a> but will also include <code class="docutils literal notranslate"><span class="pre">outputs</span></code> as a variable.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="outputs">
<h3>Outputs<a class="headerlink" href="#outputs" title="Permalink to this headline"></a></h3>
<p>Keys declared as outputs are used as the names of the Ansible facts to be extracted after the playbook completes.</p>
</section>
<section id="implementation-key-notes">
<h3><code class="docutils literal notranslate"><span class="pre">implementation</span></code> key notes<a class="headerlink" href="#implementation-key-notes" title="Permalink to this headline"></a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">operation_host</dt>
<dd class="field-odd"><p>If set, names the Ansible host.</p>
</dd>
<dt class="field-even">environment</dt>
<dd class="field-even"><p>If set, environment directives will processed and passed to the playbook’s <code class="docutils literal notranslate"><span class="pre">environment</span></code></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="playbook-processing">
<h3>Playbook processing<a class="headerlink" href="#playbook-processing" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">playbook</span></code> input can be set to a full playbook or a list of tasks. If inventory is auto-generated and the “hosts” keyword is empty or missing from the playbook, “hosts” will be set to the host found in the auto-generated inventory, as described below.</p>
</section>
<section id="inventory">
<h3>Inventory<a class="headerlink" href="#inventory" title="Permalink to this headline"></a></h3>
<p>If an inventory file isn’t specified in <code class="docutils literal notranslate"><span class="pre">inputs</span></code>, Unfurl will generate an Ansible inventory for the target host. The target host will be selected by searching for a node in the following order:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">operation_host</span></code> if explicitly set.</p></li>
<li><p>The current target if it looks like a host (i.e. has an Ansible or SSH endpoint or is a Compute resource)</p></li>
<li><p>Search the current target’s <code class="docutils literal notranslate"><span class="pre">hostedOn</span></code> relationship for a node that looks like a host.</p></li>
<li><p>Fallback to “localhost” with a local ansible connection.</p></li>
</ul>
<p>The inventory facts for the selected host is built from the following sources:</p>
<ul class="simple">
<li><p>If host has an <code class="docutils literal notranslate"><span class="pre">endpoint</span></code> of  type <code class="docutils literal notranslate"><span class="pre">unfurl.capabilities.Endpoint.SSH</span></code> or <code class="docutils literal notranslate"><span class="pre">unfurl.capabilities.Endpoint.Ansible</span></code> use that capability’s <code class="docutils literal notranslate"><span class="pre">host</span></code>, <code class="docutils literal notranslate"><span class="pre">port</span></code>, <code class="docutils literal notranslate"><span class="pre">connection</span></code>, <code class="docutils literal notranslate"><span class="pre">user</span></code>, and <code class="docutils literal notranslate"><span class="pre">hostvars</span></code> properties.</p></li>
<li><p>If there is a relationship template or connection of
type <code class="docutils literal notranslate"><span class="pre">unfurl.relationships.ConnectsTo.Ansible</span></code> that targets the endpoint, uses its <code class="docutils literal notranslate"><span class="pre">credential</span></code> and <code class="docutils literal notranslate"><span class="pre">hostvars</span></code> properties. (These can be set in the environment’s <a class="reference internal" href="runtime.html#connections"><span class="std std-ref">Connections</span></a> section.)</p></li>
<li><p>If the host is declared as a member of group of type <code class="docutils literal notranslate"><span class="pre">unfurl.groups.AnsibleInventoryGroup</span></code> in the service template,
the group’s name will be added as an ansible group along with the contents of the group’s <code class="docutils literal notranslate"><span class="pre">hostvars</span></code> property.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">ansible_host</span></code> wasn’t previously set, <code class="docutils literal notranslate"><span class="pre">ansible_host</span></code> will be set to the host’s <a class="reference internal" href="toscadef.html#tosca-types"><span class="std std-ref">public_ip</span></a> or <code class="docutils literal notranslate"><span class="pre">private_ip</span></code> in that order if present, otherwise set it to <code class="docutils literal notranslate"><span class="pre">localhost</span></code>.</p></li>
<li><p>If the host is a Google compute instance the host name will be set to <code class="docutils literal notranslate"><span class="pre">INSTANCE_NAME.ZONE.PROJECT</span></code> e.g. <code class="docutils literal notranslate"><span class="pre">instance-1.us-central1-a.purple-sanctum-25912</span></code>. This is for compatibility with the <code class="docutils literal notranslate"><span class="pre">gcloud</span> <span class="pre">compute</span> <span class="pre">config-ssh</span></code> command to enable Unfurl to use those credentials.</p></li>
</ul>
</section>
<section id="execution-environment">
<h3>Execution environment<a class="headerlink" href="#execution-environment" title="Permalink to this headline"></a></h3>
<blockquote>
<div><p>Unfurl runs Ansible in an environment isolated from your machine’s Ansible installation
and will not load the ansible configuration files in the standard locations.
If you want to load an Ansible configuration file set the <code class="docutils literal notranslate"><span class="pre">ANSIBLE_CONFIG</span></code> environment variable.
If you want Ansible to search standard locations set to an empty or invalid value like <code class="docutils literal notranslate"><span class="pre">ANSIBLE_CONFIG=</span></code>.
(See also the <a class="reference external" href="https://docs.ansible.com/ansible/latest/reference_appendices/config.html#the-configuration-file.">Ansible Configurations Documentation</a>)</p>
<p>Note: Because Ansible is initialized at the beginning of execution,
if the <code class="docutils literal notranslate"><span class="pre">--no-runtime</span></code> command option is used or if no runtime is available
<code class="docutils literal notranslate"><span class="pre">ANSIBLE_CONFIG</span></code> will only be applied in the environment that executes Unfurl.
It will not be applied if set via <a class="reference internal" href="jsonschema.html#environment"><span class="std std-ref">environment</span></a> declaration.</p>
</div></blockquote>
</section>
</section>
<section id="cmd">
<h2><a class="toc-backref" href="#id40">Cmd</a><a class="headerlink" href="#cmd" title="Permalink to this headline"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Cmd</span></code> configurator executes a shell command using either the <a class="reference internal" href="#shell"><span class="std std-ref">Shell</span></a> configurator
or the <a class="reference internal" href="#ansible"><span class="std std-ref">Ansible</span></a> configurator for remote execution if the <code class="docutils literal notranslate"><span class="pre">operation_host</span></code> is set to a remote node.
As described above, <code class="docutils literal notranslate"><span class="pre">Cmd</span></code> is the default configurator if none is specified.</p>
<section id="id2">
<h3>Example<a class="headerlink" href="#id2" title="Permalink to this headline"></a></h3>
<p>In this example, <code class="docutils literal notranslate"><span class="pre">operation_host</span></code> is set to a remote instance so the command is executed remotely using Ansible.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-4" name="sd-tab-set-2" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-YAML" for="sd-tab-item-4">
YAML</label><div class="sd-tab-content docutils">
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ensemble</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">service_template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">topology_template</span><span class="p">:</span>
<span class="w">      </span><span class="nt">node_templates</span><span class="p">:</span>
<span class="w">        </span><span class="nt">test_remote</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca:Root</span>
<span class="w">          </span><span class="nt">interfaces</span><span class="p">:</span>
<span class="w">            </span><span class="nt">Standard</span><span class="p">:</span>
<span class="w">              </span><span class="nt">configure</span><span class="p">:</span>
<span class="w">                </span><span class="nt">implementation</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">primary</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Cmd</span>
<span class="w">                  </span><span class="nt">operation_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">staging.example.com</span>
<span class="w">                </span><span class="nt">inputs</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">cmd</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">echo &quot;test&quot;</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-5" name="sd-tab-set-2" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-python" for="sd-tab-item-5">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">unfurl.configurators</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tosca</span>
<span class="nd">@tosca</span><span class="o">.</span><span class="n">operation</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;configure&quot;</span><span class="p">,</span> <span class="n">operation_host</span><span class="o">=</span><span class="s2">&quot;staging.example.com&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_remote_configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">unfurl</span><span class="o">.</span><span class="n">configurators</span><span class="o">.</span><span class="n">CmdConfigurator</span><span class="p">(</span>
        <span class="n">cmd</span><span class="o">=</span><span class="s1">&#39;echo &quot;test&quot;&#39;</span><span class="p">,</span>
    <span class="p">)</span>


<span class="n">test_remote</span> <span class="o">=</span> <span class="n">tosca</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Root</span><span class="p">()</span>
<span class="n">test_remote</span><span class="o">.</span><span class="n">set_operation</span><span class="p">(</span><span class="n">test_remote_configure</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="delegate">
<h2><a class="toc-backref" href="#id41">Delegate</a><a class="headerlink" href="#delegate" title="Permalink to this headline"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">delegate</span></code> configurator will delegate the current operation to the specified one.</p>
<section id="id3">
<h3>Inputs<a class="headerlink" href="#id3" title="Permalink to this headline"></a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">operation</dt>
<dd class="field-odd"><p>(<em>required</em>) The operation to delegate to, e.g. <code class="docutils literal notranslate"><span class="pre">Standard.configure</span></code></p>
</dd>
<dt class="field-even">target</dt>
<dd class="field-even"><p>The name of the instance to delegate to. If omitted the current target will be used.</p>
</dd>
<dt class="field-odd">inputs</dt>
<dd class="field-odd"><p>Inputs to pass to the operation. If omitted the current inputs will be used.</p>
</dd>
<dt class="field-even">when</dt>
<dd class="field-even"><p>If set, only perform the delegated operation if its value evaluates to true.</p>
</dd>
</dl>
</div></blockquote>
</section>
</section>
<section id="shell">
<span id="shell-configurator"></span><h2><a class="toc-backref" href="#id42">Shell</a><a class="headerlink" href="#shell" title="Permalink to this headline"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Shell</span></code> configurator executes a shell command.</p>
<section id="inline-shell-script-example">
<h3>Inline shell script example<a class="headerlink" href="#inline-shell-script-example" title="Permalink to this headline"></a></h3>
<p>This example executes an inline shell script and uses the <code class="docutils literal notranslate"><span class="pre">cwd</span></code> and <code class="docutils literal notranslate"><span class="pre">shell</span></code> input options.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-6" name="sd-tab-set-3" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-YAML" for="sd-tab-item-6">
YAML</label><div class="sd-tab-content docutils">
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ensemble</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">service_template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">topology_template</span><span class="p">:</span>
<span class="w">      </span><span class="nt">node_templates</span><span class="p">:</span>
<span class="w">        </span><span class="nt">shellscript-example</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca:Root</span>
<span class="w">          </span><span class="nt">interfaces</span><span class="p">:</span>
<span class="w">            </span><span class="nt">Standard</span><span class="p">:</span>
<span class="w">              </span><span class="nt">configure</span><span class="p">:</span>
<span class="w">                </span><span class="nt">implementation</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">                  </span><span class="no">if ! [ -x &quot;$(command -v testvars)&quot; ]; then</span>
<span class="w">                    </span><span class="no">source testvars.sh</span>
<span class="w">                  </span><span class="no">fi</span>
<span class="w">                </span><span class="nt">inputs</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">cwd</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">&quot;project&quot;</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">get_dir</span><span class="nv"> </span><span class="s">}}&#39;</span>
<span class="w">                    </span><span class="nt">keeplines</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">                    </span><span class="c1"># our script requires bash</span>
<span class="w">                    </span><span class="nt">shell</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">&quot;bash&quot;</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">which</span><span class="nv"> </span><span class="s">}}&#39;</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-7" name="sd-tab-set-3" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-python" for="sd-tab-item-7">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@operation</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;configure&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">shellscript_example_configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">unfurl</span><span class="o">.</span><span class="n">configurators</span><span class="o">.</span><span class="n">shell</span><span class="o">.</span><span class="n">ShellConfigurator</span><span class="p">(</span>
        <span class="n">command</span><span class="o">=</span><span class="s1">&#39;if ! [ -x &quot;$(command -v testvars)&quot; ]; then</span><span class="se">\n</span><span class="s1">  source testvars.sh</span><span class="se">\n</span><span class="s1">fi</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="n">cwd</span><span class="o">=</span><span class="n">Eval</span><span class="p">(</span><span class="s1">&#39;{{ &quot;project&quot; | get_dir }}&#39;</span><span class="p">),</span>
        <span class="n">keeplines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">shell</span><span class="o">=</span><span class="n">Eval</span><span class="p">(</span><span class="s1">&#39;{{ &quot;bash&quot; | which }}&#39;</span><span class="p">),</span>
    <span class="p">)</span>

<span class="n">shellscript_example</span> <span class="o">=</span> <span class="n">tosca</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Root</span><span class="p">()</span>
<span class="n">shellscript_example</span><span class="o">.</span><span class="n">set_operation</span><span class="p">(</span><span class="n">shellscript_example_configure</span><span class="p">)</span>

</pre></div>
</div>
</div>
</div>
</section>
<section id="example-with-artifact">
<h3>Example with artifact<a class="headerlink" href="#example-with-artifact" title="Permalink to this headline"></a></h3>
<p>Declaring an artifact of a type that is associated with the shell configurator
ensures Unfurl will install the artifact if necessary, before it runs the command.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-8" name="sd-tab-set-4" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-yaml" for="sd-tab-item-8">
YAML</label><div class="sd-tab-content docutils">
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ensemble</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">service_template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">imports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">repository</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl</span>
<span class="w">      </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca_plugins/artifacts.yaml</span>
<span class="w">    </span><span class="nt">node_types</span><span class="p">:</span>
<span class="w">      </span><span class="nt">artifact_example</span><span class="p">:</span>
<span class="w">          </span><span class="nt">derived_from</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca:Root</span>
<span class="w">          </span><span class="nt">artifacts</span><span class="p">:</span>
<span class="w">            </span><span class="nt">ripgrep</span><span class="p">:</span>
<span class="w">              </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">artifact.AsdfTool</span>
<span class="w">              </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ripgrep</span>
<span class="w">              </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">                </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">13.0.0</span>
<span class="w">          </span><span class="nt">interfaces</span><span class="p">:</span>
<span class="w">            </span><span class="nt">Standard</span><span class="p">:</span>
<span class="w">              </span><span class="nt">configure</span><span class="p">:</span>
<span class="w">                </span><span class="nt">implementation</span><span class="p">:</span><span class="w"> </span>
<span class="w">                  </span><span class="nt">primary</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ripgrep</span>
<span class="w">                </span><span class="nt">inputs</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">cmd</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rg search</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-9" name="sd-tab-set-4" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-python" for="sd-tab-item-9">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">unfurl.tosca_plugins.artifacts</span><span class="w"> </span><span class="kn">import</span> <span class="n">artifact_AsdfTool</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tosca</span>

<span class="k">class</span><span class="w"> </span><span class="nc">artifact_example</span><span class="p">(</span><span class="n">tosca</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Root</span><span class="p">):</span>
    <span class="n">ripgrep</span><span class="p">:</span> <span class="n">artifact_AsdfTool</span> <span class="o">=</span> <span class="n">artifact_AsdfTool</span><span class="p">(</span>
        <span class="s2">&quot;ripgrep&quot;</span><span class="p">,</span>
        <span class="n">version</span><span class="o">=</span><span class="s2">&quot;13.0.0&quot;</span><span class="p">,</span>
        <span class="n">file</span><span class="o">=</span><span class="s2">&quot;ripgrep&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ripgrep</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
            <span class="n">cmd</span><span class="o">=</span><span class="s2">&quot;rg search&quot;</span><span class="p">,</span>
        <span class="p">)</span>

</pre></div>
</div>
</div>
</div>
</section>
<section id="id4">
<h3>Inputs<a class="headerlink" href="#id4" title="Permalink to this headline"></a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">command</dt>
<dd class="field-odd"><p>(<em>required</em>) The command to execute It can be either a string or a list of command arguments.</p>
</dd>
<dt class="field-even">arguments</dt>
<dd class="field-even"><p>A map of arguments to pass to the command.</p>
</dd>
<dt class="field-odd">cwd</dt>
<dd class="field-odd"><p>Set the current working directory to execute the command in.</p>
</dd>
<dt class="field-even">dryrun</dt>
<dd class="field-even"><p>During a during a dryrun job this will be either appended to the command line
or replace the string <code class="docutils literal notranslate"><span class="pre">%dryrun%</span></code> if it appears in the command. (<code class="docutils literal notranslate"><span class="pre">%dryrun%</span></code> is stripped out when running regular jobs.)
If not set, the task will not be executed at all during a dry run job.</p>
</dd>
<dt class="field-odd">shell</dt>
<dd class="field-odd"><p>If a string, the executable of the shell to execute the command in (e.g. <code class="docutils literal notranslate"><span class="pre">/usr/bin/bash</span></code>).
A boolean indicates whether the command if invoked through the default shell or not.
If omitted, it will be set to true if <code class="docutils literal notranslate"><span class="pre">command</span></code> is a string or false if it is a list.</p>
</dd>
<dt class="field-even">echo</dt>
<dd class="field-even"><p>A boolean that indicates whether or not should be standard output (and stderr)
should be echoed to Unfurl’s stdout while the command is being run.
If omitted, true unless running with <code class="docutils literal notranslate"><span class="pre">--quiet</span></code>.
(Doesn’t affect the capture of stdout and stderr.)</p>
</dd>
<dt class="field-odd">input</dt>
<dd class="field-odd"><p>Optional string to pass as stdin.</p>
</dd>
<dt class="field-even">keeplines</dt>
<dd class="field-even"><p>(<em>Default: false</em>) If true, preserve line breaks in the given command.</p>
</dd>
<dt class="field-odd">done</dt>
<dd class="field-odd"><p>As as <a class="reference internal" href="api.html#unfurl.configurator.TaskView.done" title="unfurl.configurator.TaskView.done"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">done</span></code></a> defined by the <a class="reference internal" href="expressions.html#template"><span class="std std-ref">template</span></a> configurator.</p>
</dd>
<dt class="field-even">outputsTemplate</dt>
<dd class="field-even"><p>A <a class="reference internal" href="processing.html#ansible-jinja2-templates"><span class="std std-ref">Jinja2 template</span></a> or runtime expression that is processed after shell command completes, with same variables as <code class="docutils literal notranslate"><span class="pre">resultTemplate</span></code>. The template should evaluate to a map to be used as the operation’s outputs or null to skip.</p>
</dd>
<dt class="field-odd">resultTemplate</dt>
<dd class="field-odd"><p>A <a class="reference internal" href="processing.html#ansible-jinja2-templates"><span class="std std-ref">Jinja2 template</span></a> or runtime expression that is processed after shell command completes, it will have the following template variables:</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="result-template-variables">
<span id="resulttemplate"></span><h3>Result template variables<a class="headerlink" href="#result-template-variables" title="Permalink to this headline"></a></h3>
<p>All values will be either string or null unless otherwise noted.</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">success</dt>
<dd class="field-odd"><p><em>true</em> unless an error occurred or the returncode wasn’t 0</p>
</dd>
<dt class="field-even">cmd</dt>
<dd class="field-even"><p>(string) The command line that was executed</p>
</dd>
<dt class="field-odd">stdout</dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">stderr</dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">returncode</dt>
<dd class="field-odd"><p>Integer (Null if the process didn’t complete)</p>
</dd>
<dt class="field-even">error</dt>
<dd class="field-even"><p>Set if an exception was raised</p>
</dd>
<dt class="field-odd">timeout</dt>
<dd class="field-odd"><p>(Null unless a timeout occurred)</p>
</dd>
</dl>
</div></blockquote>
<p>The processing the <code class="docutils literal notranslate"><span class="pre">resultsTemplate</span></code> is equivalent to passing its resulting YAML to <a class="reference internal" href="api.html#unfurl.configurator.TaskView.update_instances" title="unfurl.configurator.TaskView.update_instances"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">update_instances</span></code></a>.</p>
</section>
<section id="id5">
<h3>Outputs<a class="headerlink" href="#id5" title="Permalink to this headline"></a></h3>
<p>No outputs are set unless <code class="docutils literal notranslate"><span class="pre">outputsTemplate</span></code> is present.</p>
</section>
</section>
<section id="template">
<h2><a class="toc-backref" href="#id43">Template</a><a class="headerlink" href="#template" title="Permalink to this headline"></a></h2>
<p>The template configurator lets you implement an operation entirely within the template.</p>
<section id="id6">
<h3>Inputs<a class="headerlink" href="#id6" title="Permalink to this headline"></a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">run</dt>
<dd class="field-odd"><p>Sets the <code class="docutils literal notranslate"><span class="pre">result</span></code> of this task.</p>
</dd>
<dt class="field-even">dryrun</dt>
<dd class="field-even"><p>During a <code class="docutils literal notranslate"><span class="pre">--dryrun</span></code> job used instead of <code class="docutils literal notranslate"><span class="pre">run</span></code>.</p>
</dd>
<dt class="field-odd">done</dt>
<dd class="field-odd"><p>If set, a map whose values are passed as arguments to <a class="reference internal" href="api.html#unfurl.configurator.TaskView.done" title="unfurl.configurator.TaskView.done"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unfurl.configurator.TaskView.done()</span></code></a>.
Embedded runtime expressions can access the previous value of those arguments as variables.</p>
</dd>
<dt class="field-even">resultTemplate</dt>
<dd class="field-even"><p>A Jinja2 template or runtime expression that is processed with results of <code class="docutils literal notranslate"><span class="pre">run</span></code> as its variables.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id7">
<h3>Outputs<a class="headerlink" href="#id7" title="Permalink to this headline"></a></h3>
<p>Operation outputs are set from the <a class="reference internal" href="tosca.html#operation-outputs"><span class="std std-ref">outputs</span></a> key on the <code class="docutils literal notranslate"><span class="pre">done</span></code> input if present.</p>
</section>
</section>
<section id="terraform">
<span id="id8"></span><h2><a class="toc-backref" href="#id44">Terraform</a><a class="headerlink" href="#terraform" title="Permalink to this headline"></a></h2>
<p>The Terraform configurator will be invoked on any <a class="reference internal" href="tosca.html#node-template"><span class="std std-ref">Node Template</span></a> with the type <a class="reference internal" href="toscadef.html#unfurl-types"><span class="std std-ref">unfurl.nodes.Installer.Terraform</span></a>.
It can also be used to implement any operation regardless of the node type by setting the <code class="docutils literal notranslate"><span class="pre">implementation</span></code> to <code class="docutils literal notranslate"><span class="pre">Terraform</span></code>.
It will invoke the appropriate terraform command (e.g “apply” or “destroy”) based on the job’s workflow.</p>
<p>Unless you set the <code class="docutils literal notranslate"><span class="pre">stateLocation</span></code> input parameter to “remote”, the Terraform configurator manages the Terraform state file itself
and commits it to the ensemble’s repository so you don’t use Terraform’s remote state – it will be self-contained and sharable like the rest of the Ensemble.
Any sensitive state will be encrypted using Ansible Vault.</p>
<p>During a <code class="docutils literal notranslate"><span class="pre">--dryrun</span></code> job the configurator will validate and generate the Terraform plan but not execute it. You can override this behavior with the <code class="docutils literal notranslate"><span class="pre">dryrun_mode</span></code> input parameter and you can specify dummy outputs to use with the <code class="docutils literal notranslate"><span class="pre">dryrun_outputs</span></code> input parameter.</p>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">unfurl.nodes.Installer.Terraform</span></code> node type with your node template to the avoid boilerplate and set the needed inputs.</p>
<section id="id9">
<h3>Example<a class="headerlink" href="#id9" title="Permalink to this headline"></a></h3>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-10" name="sd-tab-set-5" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-yaml" for="sd-tab-item-10">
YAML</label><div class="sd-tab-content docutils">
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ensemble</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">service_template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">imports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">repository</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl</span>
<span class="w">      </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca_plugins/artifacts.yaml</span>
<span class="w">    </span><span class="nt">topology_template</span><span class="p">:</span>
<span class="w">      </span><span class="nt">node_templates</span><span class="p">:</span>

<span class="w">        </span><span class="nt">terraform-example</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl.nodes.Installer.Terraform</span>
<span class="w">          </span><span class="nt">interfaces</span><span class="p">:</span>
<span class="w">            </span><span class="nt">defaults</span><span class="p">:</span>
<span class="w">              </span><span class="nt">inputs</span><span class="p">:</span>
<span class="w">                </span><span class="nt">tfvars</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test</span>
<span class="w">                </span><span class="nt">main</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">                  </span><span class="no">variable &quot;tag&quot; {</span>
<span class="w">                    </span><span class="no">type        = string</span>
<span class="w">                  </span><span class="no">}</span>

<span class="w">                  </span><span class="no">output &quot;name&quot; {</span>
<span class="w">                    </span><span class="no">value = var.tag</span>
<span class="w">                  </span><span class="no">}</span>
<span class="w">            </span><span class="nt">Standard</span><span class="p">:</span>
<span class="w">              </span><span class="nt">operations</span><span class="p">:</span>
<span class="w">                </span><span class="nt">configure</span><span class="p">:</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-11" name="sd-tab-set-5" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-python" for="sd-tab-item-11">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">tosca</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">unfurl</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">unfurl.tosca_plugins.artifacts</span><span class="w"> </span><span class="kn">import</span> <span class="n">unfurl_nodes_Installer_Terraform</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">unfurl.configurators.terraform</span>


<span class="nd">@tosca</span><span class="o">.</span><span class="n">operation</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">apply_to</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Install.check&quot;</span><span class="p">,</span> <span class="s2">&quot;Standard.configure&quot;</span><span class="p">,</span> <span class="s2">&quot;Standard.delete&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">terraform_example_default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">unfurl</span><span class="o">.</span><span class="n">configurators</span><span class="o">.</span><span class="n">terraform</span><span class="o">.</span><span class="n">TerraformConfigurator</span><span class="p">(</span>
        <span class="n">tfvars</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;test&quot;</span><span class="p">},</span>
        <span class="n">main</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">      variable &quot;tag&quot; {</span>
<span class="s2">        type  = string</span>
<span class="s2">      }</span>
<span class="s2">      output &quot;name&quot; {</span>
<span class="s2">        value = var.tag</span>
<span class="s2">      }&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">terraform_example</span> <span class="o">=</span> <span class="n">unfurl_nodes_Installer_Terraform</span><span class="p">()</span>
<span class="n">terraform_example</span><span class="o">.</span><span class="n">set_operation</span><span class="p">(</span><span class="n">terraform_example_default</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id10">
<h3>Inputs<a class="headerlink" href="#id10" title="Permalink to this headline"></a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">main</dt>
<dd class="field-odd"><p>The contents of the root Terraform module or a path to a directory containing the Terraform configuration. If it is a directory path, the configurator will treat it as a local Terraform module. Otherwise, if <code class="docutils literal notranslate"><span class="pre">main</span></code> is a string it will be treated as HCL and if it is a map, it will be written out as JSON. (See the note below about HCL in YAML.) If omitted, the configurator will look in <code class="docutils literal notranslate"><span class="pre">get_dir(&quot;spec.home&quot;)</span></code> for the Terraform configuration.</p>
</dd>
<dt class="field-even">tfvars</dt>
<dd class="field-even"><p>A map of Terraform variables to passed to the main Terraform module or a string equivalent to “.tfvars” file.</p>
</dd>
<dt class="field-odd">stateLocation</dt>
<dd class="field-odd"><p>If set to “secrets” (the default) the Terraform state file will be encrypted and saved into the instance’s “secrets” folder.
If set to “artifacts”, it will be saved in the instance’s “artifacts” folder with only sensitive values encrypted inline.
If set to “remote”, Unfurl will not manage the Terraform state at all.</p>
</dd>
<dt class="field-even">command</dt>
<dd class="field-even"><p>Path to the <code class="docutils literal notranslate"><span class="pre">terraform</span></code> executable. Default: “terraform”</p>
</dd>
<dt class="field-odd">dryrun_mode</dt>
<dd class="field-odd"><p>How to run during a dry run job. If set to “plan” just generate the Terraform plan. If set to “real”, run the task without any dry run logic. Default: “plan”</p>
</dd>
<dt class="field-even">dryrun_outputs</dt>
<dd class="field-even"><p>During a dry run job, this map of outputs will be used simulate the task’s outputs (otherwise outputs will be empty).</p>
</dd>
<dt class="field-odd">resultTemplate</dt>
<dd class="field-odd"><p>A Jinja2 template or runtime expression that is processed with the Terraform state JSON file as its variables as well as the <a class="reference internal" href="#resulttemplate"><span class="std std-ref">Result template variables</span></a> variables documented above for <a class="reference internal" href="#shell"><span class="std std-ref">Shell</span></a>.
See the Terraform providers’ schema documentation for details but top-level keys will include “resources” and “outputs”.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id11">
<h3>Outputs<a class="headerlink" href="#id11" title="Permalink to this headline"></a></h3>
<p>Specifies which outputs defined by the Terraform module that will be set as the operation’s outputs. If omitted and the Terraform configuration is specified inline, all of the Terraform outputs will be included. But if a Terraform configuration directory was specified instead, its outputs need to be declared here to be exposed.</p>
</section>
<section id="tfvar-and-tfoutput-metadata">
<h3><code class="docutils literal notranslate"><span class="pre">tfvar</span></code> and <code class="docutils literal notranslate"><span class="pre">tfoutput</span></code> Metadata<a class="headerlink" href="#tfvar-and-tfoutput-metadata" title="Permalink to this headline"></a></h3>
<p>You can automatically map properties and attributes to a Terraform variables and outputs by setting <code class="docutils literal notranslate"><span class="pre">tfvar</span></code> and <code class="docutils literal notranslate"><span class="pre">tfoutput</span></code> keys in the property and attribute metadata, respectively. For example:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-12" name="sd-tab-set-6" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-yaml" for="sd-tab-item-12">
YAML</label><div class="sd-tab-content docutils">
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">node_types</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ExampleTerraformManagedResource</span><span class="p">:</span>
<span class="w">    </span><span class="nt">derived_from</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca.nodes.Root</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">A type of resource that is managed (create/update/delete) by a terraform</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">resource</span>
<span class="w">    </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">      </span><span class="nt">example_terraform_var</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">A property the UI will render for user input</span>
<span class="w">        </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">          </span><span class="c1"># TOSCA properties are conceptually similar to Terraform variables.</span>
<span class="w">          </span><span class="c1"># This declares that this property will set as a terraform variable with the same name:</span>
<span class="w">          </span><span class="nt">tfvar</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">attributes</span><span class="p">:</span>
<span class="w">      </span><span class="nt">example_terraform_output</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">        </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">          </span><span class="c1"># TOSCA attributes are conceptually similar to Terraform outputs.</span>
<span class="w">          </span><span class="c1"># This declares that this attribute will be set to the terraform output with the same name:</span>
<span class="w">          </span><span class="nt">tfoutput</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">interfaces</span><span class="p">:</span><span class="w">      </span>
<span class="w">      </span><span class="nt">Install</span><span class="p">:</span>
<span class="w">        </span><span class="nt">operations</span><span class="p">:</span>
<span class="w">          </span><span class="nt">check</span><span class="p">:</span>
<span class="w">      </span><span class="nt">Standard</span><span class="p">:</span>
<span class="w">        </span><span class="nt">operations</span><span class="p">:</span>
<span class="w">          </span><span class="nt">configure</span><span class="p">:</span>
<span class="w">          </span><span class="nt">delete</span><span class="p">:</span>
<span class="w">      </span><span class="nt">defaults</span><span class="p">:</span>
<span class="w">        </span><span class="c1"># set this operation for the basic CRUD operations in the TOSCA deploy workflow</span>
<span class="w">        </span><span class="nt">implementation</span><span class="p">:</span>
<span class="w">          </span><span class="nt">className</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl.configurators.terraform.TerraformConfigurator</span>
<span class="w">        </span><span class="nt">inputs</span><span class="p">:</span>
<span class="w">          </span><span class="nt">main</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">terraform</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-13" name="sd-tab-set-6" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-python" for="sd-tab-item-13">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">unfurl.configurators.terraform</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">TerraformConfigurator</span><span class="p">,</span>
    <span class="n">TerraformInputs</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">unfurl.tosca_plugins.expr</span><span class="w"> </span><span class="kn">import</span> <span class="n">tfvar</span><span class="p">,</span> <span class="n">tfoutput</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tosca</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ExampleTerraformManagedResource</span><span class="p">(</span><span class="n">tosca</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Root</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A type of resource that is managed (create/update/delete) by a terraform resource&quot;&quot;&quot;</span>

    <span class="c1"># TOSCA properties are conceptually similar to Terraform variables.</span>
    <span class="c1"># Set the tfvar option to indicate the property should set a Terraform variable with the same name.</span>
    <span class="n">example_terraform_var</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">tosca</span><span class="o">.</span><span class="n">Property</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">tfvar</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A property the UI will render for user input&quot;&quot;&quot;</span>

    <span class="c1"># TOSCA attributes are conceptually similar to Terraform outputs.</span>
    <span class="c1"># Set the tfoutput option to indicate the attribute should be set to the terraform output with the same name.</span>
    <span class="n">example_terraform_output</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">tosca</span><span class="o">.</span><span class="n">Attribute</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">tfoutput</span><span class="p">)</span>

    <span class="c1"># call this function for the basic CRUD operations in the TOSCA deploy workflow</span>
    <span class="nd">@tosca</span><span class="o">.</span><span class="n">operation</span><span class="p">(</span><span class="n">apply_to</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Install.check&quot;</span><span class="p">,</span> <span class="s2">&quot;Standard.configure&quot;</span><span class="p">,</span> <span class="s2">&quot;Standard.delete&quot;</span><span class="p">])</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TerraformConfigurator</span><span class="p">:</span>
        <span class="c1"># Implement these operations using the Terraform module found in the directory named &quot;terraform&quot;</span>
        <span class="k">return</span> <span class="n">TerraformConfigurator</span><span class="p">(</span><span class="n">TerraformInputs</span><span class="p">(</span><span class="n">main</span><span class="o">=</span><span class="s2">&quot;terraform&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="environment-variables">
<h3>Environment Variables<a class="headerlink" href="#environment-variables" title="Permalink to this headline"></a></h3>
<p>If the <code class="docutils literal notranslate"><span class="pre">TF_DATA_DIR</span></code> environment variable is not defined it will be set to <code class="docutils literal notranslate"><span class="pre">.terraform</span></code> relative to the current working directory.</p>
</section>
<section id="note-on-hcl-in-yaml">
<h3>Note on HCL in YAML<a class="headerlink" href="#note-on-hcl-in-yaml" title="Permalink to this headline"></a></h3>
<p>The json representation of the Terraform’s HashiCorp Configuration Language (HCL) is quite readable when serialized as YAML:</p>
<p>Example 1: variable declaration</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">variable</span> <span class="s2">&quot;example&quot;</span> <span class="p">{</span>
  <span class="n">default</span> <span class="o">=</span> <span class="s2">&quot;hello&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Becomes:</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">variable</span><span class="p">:</span>
<span class="w">  </span><span class="nt">example</span><span class="p">:</span>
<span class="w">    </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello</span>
</pre></div>
</div>
<p>Example 2: Resource declaration</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">resource</span> <span class="s2">&quot;aws_instance&quot;</span> <span class="s2">&quot;example&quot;</span> <span class="p">{</span>
  <span class="n">instance_type</span> <span class="o">=</span> <span class="s2">&quot;t2.micro&quot;</span>
  <span class="n">ami</span>           <span class="o">=</span> <span class="s2">&quot;ami-abc123&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>becomes:</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">resource</span><span class="p">:</span>
<span class="w">  </span><span class="nt">aws_instance</span><span class="p">:</span>
<span class="w">   </span><span class="nt">example</span><span class="p">:</span>
<span class="w">    </span><span class="nt">instance_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">t2.micro</span>
<span class="w">    </span><span class="nt">ami</span><span class="p">:</span><span class="w">           </span><span class="l l-Scalar l-Scalar-Plain">ami-abc123</span>
</pre></div>
</div>
<p>Example 3: Resource with multiple provisioners</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">resource</span> <span class="s2">&quot;aws_instance&quot;</span> <span class="s2">&quot;example&quot;</span> <span class="p">{</span>
  <span class="n">provisioner</span> <span class="s2">&quot;local-exec&quot;</span> <span class="p">{</span>
    <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;echo &#39;Hello World&#39; &gt;example.txt&quot;</span>
  <span class="p">}</span>
  <span class="n">provisioner</span> <span class="s2">&quot;file&quot;</span> <span class="p">{</span>
    <span class="n">source</span>      <span class="o">=</span> <span class="s2">&quot;example.txt&quot;</span>
    <span class="n">destination</span> <span class="o">=</span> <span class="s2">&quot;/tmp/example.txt&quot;</span>
  <span class="p">}</span>
  <span class="n">provisioner</span> <span class="s2">&quot;remote-exec&quot;</span> <span class="p">{</span>
    <span class="n">inline</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s2">&quot;sudo install-something -f /tmp/example.txt&quot;</span><span class="p">,</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Multiple provisioners become a list:</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">resource</span><span class="p">:</span>
<span class="w">  </span><span class="nt">aws_instance</span><span class="p">:</span>
<span class="w">    </span><span class="nt">example</span><span class="p">:</span>
<span class="w">      </span><span class="nt">provisioner</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">local-exec</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;echo</span><span class="nv"> </span><span class="s">&#39;Hello</span><span class="nv"> </span><span class="s">World&#39;</span><span class="nv"> </span><span class="s">&gt;example.txt&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">file</span><span class="p">:</span>
<span class="w">            </span><span class="nt">source</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example.txt</span>
<span class="w">            </span><span class="nt">destination</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/tmp/example.txt</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">remote-exec</span><span class="p">:</span>
<span class="w">            </span><span class="nt">inline</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;sudo</span><span class="nv"> </span><span class="s">install-something</span><span class="nv"> </span><span class="s">-f</span><span class="nv"> </span><span class="s">/tmp/example.txt&quot;</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>You can convert HCL to JSON and YAML using tools like <a class="reference external" href="https://github.com/tmccombs/hcl2json">hcl2json</a> and <a class="reference external" href="https://github.com/mikefarah/yq/">yq</a>, for example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>hcl2json<span class="w"> </span>main.tf<span class="w"> </span><span class="p">|</span><span class="w"> </span>yq<span class="w"> </span>-P<span class="w"> </span>-oyaml
</pre></div>
</div>
<p>Expressing terraform modules as YAML or JSON instead of HCL exposes the terraform in a structured way, making it easier to provide extensibility.
For example, a derived node template or artifact could add or update terraform resources defined on the base type: In the example below, a derived type customizes its base type’s <code class="docutils literal notranslate"><span class="pre">main</span></code> property without have to replace its entire definition.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>main:<span class="w"> </span><span class="s2">&quot;{{ &#39;.super::main&#39; | eval | combine(SELF.custom_changes, recursive=True, list_merge=&#39;append_rp&#39;) }}&quot;</span>
</pre></div>
</div>
<p>Here we merge the base class’s property using <code class="docutils literal notranslate"><span class="pre">.super</span></code> with a property called <code class="docutils literal notranslate"><span class="pre">custom_changes</span></code> using Ansible Jinja2’s <code class="docutils literal notranslate"><span class="pre">combine</span></code> filter which lets you recursively merge maps and lists.</p>
</section>
</section>
</section>
<section id="installers">
<h1>Installers<a class="headerlink" href="#installers" title="Permalink to this headline"></a></h1>
<p>Installer node types already have operations defined.
You just need to import the service template containing the TOSCA type definitions and
declare node templates with the needed properties and operation inputs.</p>
<div class="contents local topic" id="id12">
<ul class="simple">
<li><p><a class="reference internal" href="#docker" id="id45">Docker</a></p></li>
<li><p><a class="reference internal" href="#dns" id="id46">DNS</a></p></li>
<li><p><a class="reference internal" href="#helm" id="id47">Helm</a></p></li>
<li><p><a class="reference internal" href="#kubernetes" id="id48">Kubernetes</a></p></li>
<li><p><a class="reference internal" href="#supervisor" id="id49">Supervisor</a></p></li>
</ul>
</div>
<section id="docker">
<span id="docker-configurator"></span><h2><a class="toc-backref" href="#id45">Docker</a><a class="headerlink" href="#docker" title="Permalink to this headline"></a></h2>
<p>Required TOSCA import: <code class="docutils literal notranslate"><span class="pre">configurators/templates/docker.yaml</span></code> (in the <code class="docutils literal notranslate"><span class="pre">unfurl</span></code> repository)</p>
<section id="unfurl-nodes-container-application-docker">
<h3>unfurl.nodes.Container.Application.Docker<a class="headerlink" href="#unfurl-nodes-container-application-docker" title="Permalink to this headline"></a></h3>
<p>TOSCA node type that represents a Docker container.</p>
<section id="artifacts">
<h4>artifacts<a class="headerlink" href="#artifacts" title="Permalink to this headline"></a></h4>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">image</dt>
<dd class="field-odd"><p>(<em>required</em>) An artifact of type <code class="docutils literal notranslate"><span class="pre">tosca.artifacts.Deployment.Image.Container.Docker</span></code></p>
</dd>
</dl>
</div></blockquote>
<p>By default, the configurator will assume the image is in <a class="reference external" href="https://registry.hub.docker.com">https://registry.hub.docker.com</a>.
If the image is in a different registry you can declare it as a repository and have the <code class="docutils literal notranslate"><span class="pre">image</span></code> artifact reference that repository.</p>
</section>
</section>
<section id="id13">
<h3>Inputs<a class="headerlink" href="#id13" title="Permalink to this headline"></a></h3>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">configuration</dt>
<dd class="field-odd"><p>A map that will included as parameters to Ansible’s Docker container module
They are enumerated <a class="reference external" href="https://docs.ansible.com/ansible/latest/collections/community/docker/docker_container_module.html#ansible-collections-community-docker-docker-container-module#parameters">here</a></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id14">
<h3>Example<a class="headerlink" href="#id14" title="Permalink to this headline"></a></h3>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-14" name="sd-tab-set-7" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-yaml" for="sd-tab-item-14">
YAML</label><div class="sd-tab-content docutils">
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ensemble</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">service_template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">imports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">repository</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl</span>
<span class="w">      </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">configurators/templates/docker.yaml</span>
<span class="w">    </span><span class="nt">topology_template</span><span class="p">:</span>
<span class="w">      </span><span class="nt">node_templates</span><span class="p">:</span>
<span class="w">        </span><span class="nt">hello-world-container</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl.nodes.Container.Application.Docker</span>
<span class="w">          </span><span class="nt">artifacts</span><span class="p">:</span>
<span class="w">            </span><span class="nt">image</span><span class="p">:</span>
<span class="w">              </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca.artifacts.Deployment.Image.Container.Docker</span>
<span class="w">              </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">busybox</span>
<span class="w">          </span><span class="nt">interfaces</span><span class="p">:</span>
<span class="w">            </span><span class="nt">Standard</span><span class="p">:</span>
<span class="w">              </span><span class="nt">inputs</span><span class="p">:</span>
<span class="w">                </span><span class="nt">configuration</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;echo&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;hello</span><span class="nv"> </span><span class="s">world&quot;</span><span class="p p-Indicator">]</span>
<span class="w">                  </span><span class="nt">detach</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span>
<span class="w">                  </span><span class="nt">output_logs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-15" name="sd-tab-set-7" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-python" for="sd-tab-item-15">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">unfurl.configurators.templates.docker</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">unfurl_nodes_Container_Application_Docker</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tosca</span>

<span class="n">hello_world_container</span> <span class="o">=</span> <span class="n">unfurl_nodes_Container_Application_Docker</span><span class="p">(</span>
    <span class="s2">&quot;hello-world-container&quot;</span><span class="p">,</span>
    <span class="n">image</span><span class="o">=</span><span class="n">tosca</span><span class="o">.</span><span class="n">artifacts</span><span class="o">.</span><span class="n">DeploymentImageContainerDocker</span><span class="p">(</span>
        <span class="s2">&quot;image&quot;</span><span class="p">,</span>
        <span class="n">file</span><span class="o">=</span><span class="s2">&quot;busybox&quot;</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">)</span>
<span class="n">hello_world_container</span><span class="o">.</span><span class="n">_Standard_default_inputs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">configuration</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;echo&quot;</span><span class="p">,</span> <span class="s2">&quot;hello world&quot;</span><span class="p">],</span> <span class="n">detach</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">output_logs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="dns">
<h2><a class="toc-backref" href="#id46">DNS</a><a class="headerlink" href="#dns" title="Permalink to this headline"></a></h2>
<p>The DNS installer support nearly all major DNS providers using <a class="reference external" href="https://github.com/octodns/octodns">OctoDNS</a>.</p>
<p>Required TOSCA import: <code class="docutils literal notranslate"><span class="pre">configurators/templates/dns.yaml</span></code> (in the <code class="docutils literal notranslate"><span class="pre">unfurl</span></code> repository)</p>
<section id="unfurl-nodes-dnszone">
<h3>unfurl.nodes.DNSZone<a class="headerlink" href="#unfurl-nodes-dnszone" title="Permalink to this headline"></a></h3>
<p>TOSCA node type that represents a DNS zone.</p>
<section id="properties">
<h4>Properties<a class="headerlink" href="#properties" title="Permalink to this headline"></a></h4>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">name</dt>
<dd class="field-odd"><p>(<em>required</em>) DNS hostname of the zone (should end with “.”).</p>
</dd>
<dt class="field-even">provider</dt>
<dd class="field-even"><p>(<em>required</em>) A map containing the <a class="reference external" href="https://github.com/octodns/octodns#supported-providers">OctoDNS provider</a> configuration</p>
</dd>
<dt class="field-odd">records</dt>
<dd class="field-odd"><p>A map of DNS records to add to the zone (default: an empty map)</p>
</dd>
<dt class="field-even">exclusive</dt>
<dd class="field-even"><p>Set to true if the zone is exclusively managed by this instance (removes unrecognized records) (default: false)</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="attributes">
<h4>Attributes<a class="headerlink" href="#attributes" title="Permalink to this headline"></a></h4>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">zone</dt>
<dd class="field-odd"><p>A map containing the records found in the live zone</p>
</dd>
<dt class="field-even">managed_records</dt>
<dd class="field-even"><p>A map containing the current records that are managed by this instance</p>
</dd>
</dl>
</div></blockquote>
</section>
</section>
<section id="unfurl-relationships-dnsrecords">
<h3>unfurl.relationships.DNSRecords<a class="headerlink" href="#unfurl-relationships-dnsrecords" title="Permalink to this headline"></a></h3>
<p>TOSCA relationship type to connect a DNS record to a DNS zone.
The DNS records specified here will be added, updated or removed from the zone when the relationship is established, changed or removed.</p>
<section id="id15">
<h4>Properties<a class="headerlink" href="#id15" title="Permalink to this headline"></a></h4>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">records</dt>
<dd class="field-odd"><p>(<em>required</em>) A map containing the DNS records to add to the zone.</p>
</dd>
</dl>
</div></blockquote>
</section>
</section>
<section id="id16">
<h3>Example<a class="headerlink" href="#id16" title="Permalink to this headline"></a></h3>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-16" name="sd-tab-set-8" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-yaml" for="sd-tab-item-16">
YAML</label><div class="sd-tab-content docutils">
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ensemble</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">service_template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">imports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">repository</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl</span>
<span class="w">      </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">configurators/templates/dns.yaml</span>
<span class="w">    </span><span class="nt">topology_template</span><span class="p">:</span>
<span class="w">      </span><span class="nt">node_templates</span><span class="p">:</span>
<span class="w">        </span><span class="nt">example_com_zone</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl.nodes.DNSZone</span>
<span class="w">          </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example.com.</span>
<span class="w">            </span><span class="nt">provider</span><span class="p">:</span>
<span class="w">              </span><span class="c1"># Amazon Route53 (Note: this provider requires that the zone already exists.)</span>
<span class="w">              </span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">octodns.provider.route53.Route53Provider</span>

<span class="w">        </span><span class="nt">test_app</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca.nodes.WebServer</span>
<span class="w">          </span><span class="nt">requirements</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">compute</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">dns</span><span class="p">:</span>
<span class="w">                </span><span class="nt">node</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example_com_zone</span>
<span class="w">                </span><span class="nt">relationship</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl.relationships.DNSRecords</span>
<span class="w">                  </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">records</span><span class="p">:</span>
<span class="w">                      </span><span class="nt">www</span><span class="p">:</span>
<span class="w">                        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">A</span>
<span class="w">                        </span><span class="nt">value</span><span class="p">:</span>
<span class="w">                          </span><span class="c1"># get the ip address of the Compute instance that this is hosted on</span>
<span class="w">                          </span><span class="nt">eval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.source::.requirements::[.name=host]::.target::public_address</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-17" name="sd-tab-set-8" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-python" for="sd-tab-item-17">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">unfurl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tosca</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tosca</span><span class="w"> </span><span class="kn">import</span> <span class="n">Eval</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">unfurl.configurators.templates.dns</span><span class="w"> </span><span class="kn">import</span> <span class="n">unfurl_nodes_DNSZone</span><span class="p">,</span> <span class="n">unfurl_relationships_DNSRecords</span>

<span class="n">example_com_zone</span> <span class="o">=</span> <span class="n">unfurl_nodes_DNSZone</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;example.com.&quot;</span><span class="p">,</span>
    <span class="n">provider</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;octodns.provider.route53.Route53Provider&quot;</span><span class="p">},</span>
<span class="p">)</span>

<span class="n">test_app</span> <span class="o">=</span> <span class="n">tosca</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">WebServer</span><span class="p">(</span>
    <span class="n">host</span><span class="o">=</span><span class="p">[</span><span class="n">tosca</span><span class="o">.</span><span class="n">find_node</span><span class="p">(</span><span class="s2">&quot;compute&quot;</span><span class="p">)],</span>
<span class="p">)</span>
<span class="n">test_app</span><span class="o">.</span><span class="n">dns</span> <span class="o">=</span> <span class="n">unfurl_relationships_DNSRecords</span><span class="p">(</span>
    <span class="n">records</span><span class="o">=</span><span class="n">Eval</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;www&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>
                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;eval&quot;</span><span class="p">:</span> <span class="s2">&quot;.source::.requirements::[.name=host]::.target::public_address&quot;</span>
                <span class="p">},</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">),</span>
<span class="p">)[</span><span class="n">example_com_zone</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="helm">
<span id="id17"></span><h2><a class="toc-backref" href="#id47">Helm</a><a class="headerlink" href="#helm" title="Permalink to this headline"></a></h2>
<p>Requires Helm 3, which will be installed automatically if missing.</p>
<p>Required TOSCA import: <code class="docutils literal notranslate"><span class="pre">configurators/templates/helm.yaml</span></code> (in the <code class="docutils literal notranslate"><span class="pre">unfurl</span></code> repository)</p>
<section id="unfurl-nodes-helmrelease">
<h3>unfurl.nodes.HelmRelease<a class="headerlink" href="#unfurl-nodes-helmrelease" title="Permalink to this headline"></a></h3>
<p>TOSCA type that represents a Helm release.
Deploying or discovering a Helm release will add to the ensemble any Kubernetes resources managed by that release.</p>
<section id="requirements">
<h4>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline"></a></h4>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">host</dt>
<dd class="field-odd"><p>A node template of type <code class="docutils literal notranslate"><span class="pre">unfurl.nodes.K8sNamespace</span></code></p>
</dd>
<dt class="field-even">repository</dt>
<dd class="field-even"><p>A node template of type <code class="docutils literal notranslate"><span class="pre">unfurl.nodes.HelmRepository</span></code></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id18">
<h4>Properties<a class="headerlink" href="#id18" title="Permalink to this headline"></a></h4>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">release_name</dt>
<dd class="field-odd"><p>(<em>required</em>) The name of the helm release</p>
</dd>
<dt class="field-even">chart</dt>
<dd class="field-even"><p>The name of the chart (default: the instance name)</p>
</dd>
<dt class="field-odd">chart_values</dt>
<dd class="field-odd"><p>A map of chart values</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id19">
<h4>Inputs<a class="headerlink" href="#id19" title="Permalink to this headline"></a></h4>
<blockquote>
<div><p>All operations can be passed the following input parameters:</p>
<dl class="field-list simple">
<dt class="field-odd">flags</dt>
<dd class="field-odd"><p>A list of flags to pass to the <code class="docutils literal notranslate"><span class="pre">helm</span></code> command</p>
</dd>
</dl>
</div></blockquote>
</section>
</section>
<section id="unfurl-nodes-helmrepository">
<h3>unfurl.nodes.HelmRepository<a class="headerlink" href="#unfurl-nodes-helmrepository" title="Permalink to this headline"></a></h3>
<p>TOSCA node type that represents a Helm repository.</p>
<section id="id20">
<h4>Properties<a class="headerlink" href="#id20" title="Permalink to this headline"></a></h4>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">name</dt>
<dd class="field-odd"><p>The name of the repository (default: the instance name)</p>
</dd>
<dt class="field-even">url</dt>
<dd class="field-even"><p>(<em>required</em>) The URL of the repository</p>
</dd>
</dl>
</div></blockquote>
</section>
</section>
</section>
<section id="kubernetes">
<span id="id21"></span><h2><a class="toc-backref" href="#id48">Kubernetes</a><a class="headerlink" href="#kubernetes" title="Permalink to this headline"></a></h2>
<p>Use these types to manage Kubernetes resources.</p>
<section id="unfurl-nodes-k8scluster">
<h3>unfurl.nodes.K8sCluster<a class="headerlink" href="#unfurl-nodes-k8scluster" title="Permalink to this headline"></a></h3>
<p>TOSCA type that represents a Kubernetes cluster. Its attributes are set by introspecting the current Kubernetes connection (<code class="docutils literal notranslate"><span class="pre">unfurl.relationships.ConnectsTo.K8sCluster</span></code>).
There are no default implementations defined for creating or destroying a cluster.</p>
<section id="id22">
<h4>Attributes<a class="headerlink" href="#id22" title="Permalink to this headline"></a></h4>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">apiServer</dt>
<dd class="field-odd"><p>The url used to connect to the cluster’s api server.</p>
</dd>
</dl>
</div></blockquote>
</section>
</section>
<section id="unfurl-nodes-k8snamespace">
<h3>unfurl.nodes.K8sNamespace<a class="headerlink" href="#unfurl-nodes-k8snamespace" title="Permalink to this headline"></a></h3>
<p>Represents a Kubernetes namespace. Destroying a namespace deletes any resources in it.
Derived from <code class="docutils literal notranslate"><span class="pre">unfurl.nodes.K8sRawResource</span></code>.</p>
<section id="id23">
<h4>Requirements<a class="headerlink" href="#id23" title="Permalink to this headline"></a></h4>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">host</dt>
<dd class="field-odd"><p>A node template of type <code class="docutils literal notranslate"><span class="pre">unfurl.nodes.K8sCluster</span></code></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id24">
<h4>Properties<a class="headerlink" href="#id24" title="Permalink to this headline"></a></h4>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">name</dt>
<dd class="field-odd"><p>The name of the namespace.</p>
</dd>
</dl>
</div></blockquote>
</section>
</section>
<section id="unfurl-nodes-k8sresource">
<h3>unfurl.nodes.K8sResource<a class="headerlink" href="#unfurl-nodes-k8sresource" title="Permalink to this headline"></a></h3>
<section id="id25">
<h4>Requirements<a class="headerlink" href="#id25" title="Permalink to this headline"></a></h4>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">host</dt>
<dd class="field-odd"><p>A node template of type <code class="docutils literal notranslate"><span class="pre">unfurl.nodes.K8sNamespace</span></code></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id26">
<h4>Properties<a class="headerlink" href="#id26" title="Permalink to this headline"></a></h4>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">definition</dt>
<dd class="field-odd"><p>(map or string) The YAML definition for the Kubernetes resource.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id27">
<h4>Attributes<a class="headerlink" href="#id27" title="Permalink to this headline"></a></h4>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">apiResource</dt>
<dd class="field-odd"><p>(map) The YAML representation for the resource as retrieved from the Kubernetes cluster.</p>
</dd>
<dt class="field-even">name</dt>
<dd class="field-even"><p>(string) The Kubernetes name of the resource.</p>
</dd>
</dl>
</div></blockquote>
</section>
</section>
<section id="unfurl-nodes-k8ssecretresource">
<h3>unfurl.nodes.K8sSecretResource<a class="headerlink" href="#unfurl-nodes-k8ssecretresource" title="Permalink to this headline"></a></h3>
<p>Represents a Kubernetes secret. Derived from <code class="docutils literal notranslate"><span class="pre">unfurl.nodes.K8sResource</span></code>.</p>
<section id="id28">
<h4>Requirements<a class="headerlink" href="#id28" title="Permalink to this headline"></a></h4>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">host</dt>
<dd class="field-odd"><p>A node template of type <code class="docutils literal notranslate"><span class="pre">unfurl.nodes.K8sNamespace</span></code></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id29">
<h4>Properties<a class="headerlink" href="#id29" title="Permalink to this headline"></a></h4>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">data</dt>
<dd class="field-odd"><p>(map) Name/value pairs that define the secret. Values will be marked as sensitive.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id30">
<h4>Attributes<a class="headerlink" href="#id30" title="Permalink to this headline"></a></h4>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">apiResource</dt>
<dd class="field-odd"><p>(map) The YAML representation for the resource as retrieved from the Kubernetes cluster.  Data values will be marked as sensitive.</p>
</dd>
<dt class="field-even">name</dt>
<dd class="field-even"><p>(string) The Kubernetes name of the resource.</p>
</dd>
</dl>
</div></blockquote>
</section>
</section>
<section id="unfurl-nodes-k8srawresource">
<h3>unfurl.nodes.K8sRawResource<a class="headerlink" href="#unfurl-nodes-k8srawresource" title="Permalink to this headline"></a></h3>
<p>A Kubernetes resource that isn’t part of a namespace.</p>
<section id="id31">
<h4>Requirements<a class="headerlink" href="#id31" title="Permalink to this headline"></a></h4>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">host</dt>
<dd class="field-odd"><p>A node template of type <code class="docutils literal notranslate"><span class="pre">unfurl.nodes.K8sCluster</span></code></p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id32">
<h4>Properties<a class="headerlink" href="#id32" title="Permalink to this headline"></a></h4>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">definition</dt>
<dd class="field-odd"><p>(map or string) The YAML definition for the Kubernetes resource.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id33">
<h4>Attributes<a class="headerlink" href="#id33" title="Permalink to this headline"></a></h4>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">apiResource</dt>
<dd class="field-odd"><p>(map) The YAML representation for the resource as retrieved from the Kubernetes cluster.</p>
</dd>
<dt class="field-even">name</dt>
<dd class="field-even"><p>(string) The Kubernetes name of the resource.</p>
</dd>
</dl>
</div></blockquote>
</section>
</section>
</section>
<section id="supervisor">
<span id="sup"></span><h2><a class="toc-backref" href="#id49">Supervisor</a><a class="headerlink" href="#supervisor" title="Permalink to this headline"></a></h2>
<p><a class="reference external" href="http://supervisord.org">Supervisor</a> is a light-weight process manager that is useful when you want to run local development instances of server applications.</p>
<p>Required TOSCA import: <code class="docutils literal notranslate"><span class="pre">configurators/templates/supervisor.yaml</span></code> (in the <code class="docutils literal notranslate"><span class="pre">unfurl</span></code> repository)</p>
<section id="unfurl-nodes-supervisor">
<h3>unfurl.nodes.Supervisor<a class="headerlink" href="#unfurl-nodes-supervisor" title="Permalink to this headline"></a></h3>
<p>TOSCA type that represents an instance of Supervisor process manager. Derived from <code class="docutils literal notranslate"><span class="pre">tosca.nodes.SoftwareComponent</span></code>.</p>
<section id="id35">
<h4>properties<a class="headerlink" href="#id35" title="Permalink to this headline"></a></h4>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">homeDir</dt>
<dd class="field-odd"><p>(string) The location the Supervisor configuration directory (default: <code class="docutils literal notranslate"><span class="pre">{get_dir:</span> <span class="pre">local}</span></code>)</p>
</dd>
<dt class="field-even">confFile</dt>
<dd class="field-even"><p>(string) Name of the confiration file to create (default: <code class="docutils literal notranslate"><span class="pre">supervisord.conf</span></code>)</p>
</dd>
<dt class="field-odd">conf</dt>
<dd class="field-odd"><p>(string) The <a class="reference external" href="http://supervisord.org/configuration.html">supervisord configuration</a>. A default one will be generated if omitted.</p>
</dd>
</dl>
</div></blockquote>
</section>
</section>
<section id="unfurl-nodes-processcontroller-supervisor">
<h3>unfurl.nodes.ProcessController.Supervisor<a class="headerlink" href="#unfurl-nodes-processcontroller-supervisor" title="Permalink to this headline"></a></h3>
<p>TOSCA type that represents a process (“program” in supervisord terminology) that is managed by a Supervisor instance. Derived from <code class="docutils literal notranslate"><span class="pre">unfurl.nodes.ProcessController</span></code>.</p>
<section id="sup-requirements">
<span id="id36"></span><h4>requirements<a class="headerlink" href="#sup-requirements" title="Permalink to this headline"></a></h4>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">host</dt>
<dd class="field-odd"><p>A node template of type <code class="docutils literal notranslate"><span class="pre">unfurl.nodes.Supervisor</span></code>.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id37">
<h4>properties<a class="headerlink" href="#id37" title="Permalink to this headline"></a></h4>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">name</dt>
<dd class="field-odd"><p>(string) The name of this program.</p>
</dd>
<dt class="field-even">program</dt>
<dd class="field-even"><p>(map) A map of <a class="reference external" href="http://supervisord.org/configuration.html#program-x-section-values">settings</a> for this program.</p>
</dd>
</dl>
</div></blockquote>
</section>
</section>
</section>
</section>
<section id="id38">
<h1>Artifacts<a class="headerlink" href="#id38" title="Permalink to this headline"></a></h1>
<p>Instead of setting an operation’s <a class="reference internal" href="tosca.html#implementation"><span class="std std-ref">Implementation</span></a> to a configurator, you can set it to an <a class="reference internal" href="tosca.html#tosca-artifacts"><span class="std std-ref">artifact</span></a>.
Using an artifact allows you to reuse an implementation with more than one operation. For example, you can create artifacts for specific Terraform modules, Ansible playbooks, or executables.</p>
<p>You define an <code class="docutils literal notranslate"><span class="pre">execute</span></code> operation on an artifact’s type or template definition to specify the inputs and outputs that can be passed to the artifact’s configurator. How the inputs and outputs are used depends on the artifact’s type. For example, with a Terraform module artifact, its inputs will be used as the Terraform module’s variables and its outputs the Terraform module’s outputs. Or with a shell executable artifact, the inputs specify the command line arguments passed to the executable.</p>
<p>The example below declares an artifact that represents a shell script and shows how an operation can invoke the artifact and pass values to it.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-18" name="sd-tab-set-9" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-python" for="sd-tab-item-18">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">unfurl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tosca</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tosca</span><span class="w"> </span><span class="kn">import</span> <span class="n">ToscaOutputs</span><span class="p">,</span> <span class="n">Attribute</span><span class="p">,</span> <span class="n">Eval</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MyArtifact</span><span class="p">(</span><span class="n">unfurl</span><span class="o">.</span><span class="n">artifacts</span><span class="o">.</span><span class="n">ShellExecutable</span><span class="p">):</span>
    <span class="n">file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;myscript.sh&quot;</span>
    <span class="n">contrived_key</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">outputsTemplate</span> <span class="o">=</span> <span class="n">Eval</span><span class="p">(</span><span class="s2">&quot;{{ stdout | from_json | subelements(SELF.contrived_key)}}&quot;</span><span class="p">)</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">Outputs</span><span class="p">(</span><span class="n">ToscaOutputs</span><span class="p">):</span>
        <span class="n">a_output</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arg2</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Outputs</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">MyArtifact</span><span class="o">.</span><span class="n">Outputs</span><span class="p">()</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyNode</span><span class="p">(</span><span class="n">tosca</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Root</span><span class="p">):</span>
    <span class="n">prop1</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">prop2</span><span class="p">:</span> <span class="nb">int</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MyArtifact</span><span class="o">.</span><span class="n">Outputs</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">MyArtifact</span><span class="p">(</span><span class="n">contrived_key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prop1</span><span class="p">)</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="n">arg2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prop2</span><span class="p">)</span> 

<span class="n">my_node</span> <span class="o">=</span> <span class="n">MyNode</span><span class="p">(</span><span class="n">prop1</span><span class="o">=</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="n">prop2</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-19" name="sd-tab-set-9" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-yaml" for="sd-tab-item-19">
YAML</label><div class="sd-tab-content docutils">
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">artifact_types</span><span class="p">:</span>
<span class="w">  </span><span class="nt">MyArtifact</span><span class="p">:</span>
<span class="w">    </span><span class="nt">derived_from</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl.artifacts.ShellExecutable</span>
<span class="w">    </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">      </span><span class="nt">file</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">        </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myscript.sh</span>
<span class="w">      </span><span class="nt">contrived_key</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">      </span><span class="nt">outputsTemplate</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">        </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{{</span><span class="nv"> </span><span class="s">stdout</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">from_json</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">subelements(SELF.contrived_key)}}&#39;</span>
<span class="w">    </span><span class="nt">interfaces</span><span class="p">:</span>
<span class="w">      </span><span class="nt">Executable</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl.interfaces.Executable</span>
<span class="w">        </span><span class="nt">operations</span><span class="p">:</span>
<span class="w">          </span><span class="nt">execute</span><span class="p">:</span>
<span class="w">            </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">              </span><span class="nt">output_key</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Outputs</span>
<span class="w">            </span><span class="nt">inputs</span><span class="p">:</span>
<span class="w">              </span><span class="nt">arg1</span><span class="p">:</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">              </span><span class="nt">arg2</span><span class="p">:</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">integer</span>
<span class="w">            </span><span class="nt">outputs</span><span class="p">:</span>
<span class="w">              </span><span class="nt">a_output</span><span class="p">:</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="nt">node_types</span><span class="p">:</span>
<span class="w">  </span><span class="nt">MyNode</span><span class="p">:</span>
<span class="w">    </span><span class="nt">derived_from</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca.nodes.Root</span>
<span class="w">    </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">      </span><span class="nt">prop1</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">      </span><span class="nt">prop2</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">integer</span>
<span class="w">    </span><span class="nt">interfaces</span><span class="p">:</span>
<span class="w">      </span><span class="nt">Standard</span><span class="p">:</span>
<span class="w">        </span><span class="nt">operations</span><span class="p">:</span>
<span class="w">          </span><span class="nt">configure</span><span class="p">:</span>
<span class="w">            </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">              </span><span class="nt">output_key</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Outputs</span>
<span class="w">              </span><span class="nt">arguments</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arg1</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arg2</span>
<span class="w">            </span><span class="nt">inputs</span><span class="p">:</span>
<span class="w">              </span><span class="nt">arg1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello</span>
<span class="w">              </span><span class="nt">arg2</span><span class="p">:</span>
<span class="w">                </span><span class="nt">eval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.::prop2</span>
<span class="w">            </span><span class="nt">outputs</span><span class="p">:</span>
<span class="w">              </span><span class="nt">a_output</span><span class="p">:</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">            </span><span class="nt">implementation</span><span class="p">:</span>
<span class="w">              </span><span class="nt">primary</span><span class="p">:</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MyArtifact</span>
<span class="w">                </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">contrived_key</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">eval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.parent::.::prop1</span>
<span class="w">                </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myscript.sh</span>
<span class="nt">topology_template</span><span class="p">:</span>
<span class="w">  </span><span class="nt">node_templates</span><span class="p">:</span>
<span class="w">    </span><span class="nt">my_node</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MyNode</span>
<span class="w">      </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">        </span><span class="nt">prop1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foo</span>
<span class="w">        </span><span class="nt">prop2</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
</pre></div>
</div>
</div>
</div>
<section id="arguments">
<h2>Arguments<a class="headerlink" href="#arguments" title="Permalink to this headline"></a></h2>
<p>When node operation invokes its artifact’s <code class="docutils literal notranslate"><span class="pre">execute</span></code> operation, Unfurl looks for a operation input named <code class="docutils literal notranslate"><span class="pre">arguments</span></code> to pass as the <code class="docutils literal notranslate"><span class="pre">execute</span></code> operation’s inputs.
This should be dictionary whose keys and values corresponds to the <code class="docutils literal notranslate"><span class="pre">execute</span></code> operation’s input specification.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">arguments</span></code> isn’t explicitly declared, it will be synthesized from the following sources (listed here from lowest to highest merge order):</p>
<ul class="simple">
<li><p>Default input values defined for the execution operation.</p></li>
<li><p>Properties on the node template and on the implementation artifact if they have matching <code class="docutils literal notranslate"><span class="pre">input_match</span></code> metadata keys in their definitions (see <a class="reference internal" href="#shared-properties"><span class="std std-ref">Shared Properties</span></a>).</p></li>
<li><p>The operation’s inputs whose names are listed in the operation’s <code class="docutils literal notranslate"><span class="pre">arguments</span></code> metadata key, if set. The Python DSL generates this based on the operation method’s call to the <code class="docutils literal notranslate"><span class="pre">execute</span></code> method, as shown in the example above.</p></li>
<li><p>If the <code class="docutils literal notranslate"><span class="pre">arguments</span></code> metadata key is missing, operation inputs whose name matches execute a operation’s input name or one of the above matching property names.</p></li>
</ul>
</section>
<section id="shared-properties">
<h2>Shared Properties<a class="headerlink" href="#shared-properties" title="Permalink to this headline"></a></h2>
<p>In the Python DSL, TOSCA types can inherit from <a class="reference internal" href="api.html#tosca.ToscaInputs" title="tosca.ToscaInputs"><code class="xref py py-class docutils literal notranslate"><span class="pre">tosca.ToscaInputs</span></code></a> and  <a class="reference internal" href="api.html#tosca.ToscaOutputs" title="tosca.ToscaOutputs"><code class="xref py py-class docutils literal notranslate"><span class="pre">tosca.ToscaOutputs</span></code></a> classes using multiple inheritance and their fields will be inherited as TOSCA properties and attributes respectively. If an execute operation uses ToscaInputs as an argument in its method signature, any node or artifact that inherit that ToscaInputs class will have those properties passed as arguments. This way implementation definitions stay in sync with the nodes that use them.</p>
<p>In YAML, you can do the equivalent by adding a <code class="docutils literal notranslate"><span class="pre">input_match</span></code> metadata key to those properties to indicate they should be treated as arguments to operations. When invoking an operation, any property on the node or on the implementation artifact has that set will be added arguments. Its value can be a boolean or the name of an artifact to indicate that it should only be passed as arguments to operations that use that artifact. You can also control with properties are passed as arguments by adding an <code class="docutils literal notranslate"><span class="pre">input_match</span></code> metadata key to the artifact <code class="docutils literal notranslate"><span class="pre">execute</span></code> interface’s metadata – if set, only properties with matching <code class="docutils literal notranslate"><span class="pre">input_match</span></code> values will be set.  The YAML generated by the Python DSL uses that mechanism as the example below shows:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-20" name="sd-tab-set-10" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-python" for="sd-tab-item-20">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">unfurl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tosca</span>

<span class="k">class</span><span class="w"> </span><span class="nc">KubernetesClusterInputs</span><span class="p">(</span><span class="n">tosca</span><span class="o">.</span><span class="n">ToscaInputs</span><span class="p">):</span>
    <span class="n">do_region</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;nyc3&quot;</span> 

<span class="k">class</span><span class="w"> </span><span class="nc">KubernetesClusterOutputs</span><span class="p">(</span><span class="n">tosca</span><span class="o">.</span><span class="n">ToscaOutputs</span><span class="p">):</span>
    <span class="n">do_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">tosca</span><span class="o">.</span><span class="n">Attribute</span><span class="p">()</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ClusterTerraformModule</span><span class="p">(</span><span class="n">unfurl</span><span class="o">.</span><span class="n">artifacts</span><span class="o">.</span><span class="n">TerraformModule</span><span class="p">):</span>
    <span class="n">file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;my_module/main.tf&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">KubernetesClusterInputs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">KubernetesClusterOutputs</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">KubernetesClusterOutputs</span><span class="p">()</span>

<span class="c1"># inherited ToscaInputs and ToscaOutputs are treated as properties and attributes</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Cluster</span><span class="p">(</span><span class="n">tosca</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Root</span><span class="p">,</span> <span class="n">KubernetesClusterInputs</span><span class="p">,</span> <span class="n">KubernetesClusterOutputs</span><span class="p">):</span>
    <span class="n">cluster_config</span><span class="p">:</span> <span class="s2">&quot;ClusterTerraformModule&quot;</span> <span class="o">=</span> <span class="n">ClusterTerraformModule</span><span class="p">()</span>

    <span class="n">my_property</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">KubernetesClusterOutputs</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cluster_config</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

</pre></div>
</div>
</div>
<input id="sd-tab-item-21" name="sd-tab-set-10" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-yaml" for="sd-tab-item-21">
YAML</label><div class="sd-tab-content docutils">
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">tosca_definitions_version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca_simple_unfurl_1_0_0</span>
<span class="nt">topology_template</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">artifact_types</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ClusterTerraformModule</span><span class="p">:</span>
<span class="w">    </span><span class="nt">derived_from</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl.artifacts.TerraformModule</span>
<span class="w">    </span><span class="nt">interfaces</span><span class="p">:</span>
<span class="w">      </span><span class="nt">Executable</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl.interfaces.Executable</span>
<span class="w">        </span><span class="nt">operations</span><span class="p">:</span>
<span class="w">          </span><span class="nt">execute</span><span class="p">:</span>
<span class="w">            </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">              </span><span class="nt">output_match</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">KubernetesClusterOutputs</span>
<span class="w">              </span><span class="nt">input_match</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">KubernetesClusterInputs</span>
<span class="w">            </span><span class="nt">inputs</span><span class="p">:</span>
<span class="w">              </span><span class="nt">do_region</span><span class="p">:</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">                </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nyc3</span>
<span class="w">            </span><span class="nt">outputs</span><span class="p">:</span>
<span class="w">              </span><span class="nt">do_id</span><span class="p">:</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="nt">node_types</span><span class="p">:</span>
<span class="w">  </span><span class="nt">Cluster</span><span class="p">:</span>
<span class="w">    </span><span class="nt">derived_from</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca.nodes.Root</span>
<span class="w">    </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">      </span><span class="nt">do_region</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">        </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nyc3</span>
<span class="w">        </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">          </span><span class="nt">input_match</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">KubernetesClusterInputs</span>
<span class="w">      </span><span class="nt">my_property</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">        </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">    </span><span class="nt">attributes</span><span class="p">:</span>
<span class="w">      </span><span class="nt">do_id</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">        </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">          </span><span class="nt">output_match</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">KubernetesClusterOutputs</span>
<span class="w">    </span><span class="nt">artifacts</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cluster_config</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterTerraformModule</span>
<span class="w">        </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_module/main.tf</span>
<span class="w">    </span><span class="nt">interfaces</span><span class="p">:</span>
<span class="w">      </span><span class="nt">Standard</span><span class="p">:</span>
<span class="w">        </span><span class="nt">operations</span><span class="p">:</span>
<span class="w">          </span><span class="nt">configure</span><span class="p">:</span>
<span class="w">            </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">              </span><span class="nt">output_match</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">KubernetesClusterOutputs</span>
<span class="w">              </span><span class="nt">arguments</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">do_region</span>
<span class="w">            </span><span class="nt">inputs</span><span class="p">:</span>
<span class="w">              </span><span class="nt">do_region</span><span class="p">:</span>
<span class="w">                </span><span class="nt">eval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.::do_region</span>
<span class="w">            </span><span class="nt">outputs</span><span class="p">:</span>
<span class="w">              </span><span class="nt">do_id</span><span class="p">:</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">            </span><span class="nt">implementation</span><span class="p">:</span>
<span class="w">              </span><span class="nt">primary</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cluster_config</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="abstract-artifacts">
<h2>Abstract artifacts<a class="headerlink" href="#abstract-artifacts" title="Permalink to this headline"></a></h2>
<p>You can define abstract artifact types that just define the inputs and outputs it expects by defining an artifact type with an <code class="docutils literal notranslate"><span class="pre">execute</span></code> operation that doesn’t have an implementation declared. Artifacts can implement that by, for example, by using multiple inheritance to inherit both the abstract artifact type and a concrete artifact type like <code class="docutils literal notranslate"><span class="pre">unfurl.artifacts.TerraformModule</span></code>.</p>
<p>This way a node type can declare operations with abstract artifacts and node templates or a node subclass can set a concrete artifact without having to reimplement the operations that use it – with the assurance that the static type checker will check that operation signatures are compatible.</p>
<p>The example below defines a node type specifies the abstract artifact type its configuration operation will use and a node template that uses a concrete artifact that implements the abstract artifact type.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-22" name="sd-tab-set-11" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-python" for="sd-tab-item-22">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">unfurl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tosca</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ClusterOp</span><span class="p">(</span><span class="n">unfurl</span><span class="o">.</span><span class="n">artifacts</span><span class="o">.</span><span class="n">Executable</span><span class="p">):</span>
    <span class="n">file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;kubernetes&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">prop2</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">DOCluster</span><span class="p">(</span><span class="n">tosca</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Root</span><span class="p">):</span>
    <span class="n">cluster_config</span><span class="p">:</span> <span class="s2">&quot;ClusterOp&quot;</span>

    <span class="n">my_property</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cluster_config</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">prop1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">my_property</span><span class="p">,</span> <span class="n">prop2</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ClusterTerraform</span><span class="p">(</span><span class="n">unfurl</span><span class="o">.</span><span class="n">artifacts</span><span class="o">.</span><span class="n">TerraformModule</span><span class="p">,</span> <span class="n">ClusterOp</span><span class="p">):</span>
    <span class="n">file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;main.tf&quot;</span>

<span class="n">mycluster</span> <span class="o">=</span> <span class="n">DOCluster</span><span class="p">(</span><span class="n">cluster_config</span><span class="o">=</span><span class="n">ClusterTerraform</span><span class="p">())</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-23" name="sd-tab-set-11" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-yaml" for="sd-tab-item-23">
YAML</label><div class="sd-tab-content docutils">
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">tosca_definitions_version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca_simple_unfurl_1_0_0</span>
<span class="nt">topology_template</span><span class="p">:</span>
<span class="w">  </span><span class="nt">node_templates</span><span class="p">:</span>
<span class="w">    </span><span class="nt">mycluster</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DOCluster</span>
<span class="w">      </span><span class="nt">artifacts</span><span class="p">:</span>
<span class="w">        </span><span class="nt">cluster_config</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterTerraform</span>
<span class="w">          </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">main.tf</span>
<span class="w">      </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">        </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docs.examples.artifact3</span>
<span class="nt">artifact_types</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ClusterOp</span><span class="p">:</span>
<span class="w">    </span><span class="nt">derived_from</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl.artifacts.Executable</span>
<span class="w">    </span><span class="nt">interfaces</span><span class="p">:</span>
<span class="w">      </span><span class="nt">Executable</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl.interfaces.Executable</span>
<span class="w">        </span><span class="nt">operations</span><span class="p">:</span>
<span class="w">          </span><span class="nt">execute</span><span class="p">:</span>
<span class="w">            </span><span class="nt">inputs</span><span class="p">:</span>
<span class="w">              </span><span class="nt">prop1</span><span class="p">:</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">              </span><span class="nt">prop2</span><span class="p">:</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">integer</span>
<span class="w">  </span><span class="nt">ClusterTerraform</span><span class="p">:</span>
<span class="w">    </span><span class="nt">derived_from</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl.artifacts.TerraformModule</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterOp</span>
<span class="nt">node_types</span><span class="p">:</span>
<span class="w">  </span><span class="nt">DOCluster</span><span class="p">:</span>
<span class="w">    </span><span class="nt">derived_from</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca.nodes.Root</span>
<span class="w">    </span><span class="nt">artifacts</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cluster_config</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterOp</span>
<span class="w">    </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">      </span><span class="nt">my_property</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">        </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">    </span><span class="nt">interfaces</span><span class="p">:</span>
<span class="w">      </span><span class="nt">Standard</span><span class="p">:</span>
<span class="w">        </span><span class="nt">operations</span><span class="p">:</span>
<span class="w">          </span><span class="nt">configure</span><span class="p">:</span>
<span class="w">            </span><span class="nt">inputs</span><span class="p">:</span>
<span class="w">              </span><span class="nt">prop1</span><span class="p">:</span>
<span class="w">                </span><span class="nt">eval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.::my_property</span>
<span class="w">              </span><span class="nt">prop2</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">            </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">              </span><span class="nt">arguments</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prop1</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prop2</span>
<span class="w">            </span><span class="nt">implementation</span><span class="p">:</span>
<span class="w">              </span><span class="nt">primary</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cluster_config</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="runtime.html" class="btn btn-neutral float-left" title="Runtime Environment" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="processing.html" class="btn btn-neutral float-right" title="Template Processing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, OneCommons Co..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>