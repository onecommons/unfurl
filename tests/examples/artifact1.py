# Generated by tosca.yaml2python from docs/examples/artifact1.yaml at 2025-01-14T17:23:28 overwrite not modified (change to "overwrite ok" to allow)

import unfurl
from typing import List, Dict, Any, Tuple, Union, Sequence
import tosca
from tosca import ArtifactEntity, Eval, Node, operation



@operation(name="execute")
def _terraform_execute(self, bar=1):
    ...
# terraform_execute = operation(name="execute")

def _make_terraform() -> unfurl.artifacts.TerraformModule:
    terraform = unfurl.artifacts.TerraformModule(
        "terraform",
        resultTemplate=Eval(
            {
                "attributes": {
                    "output_attribute": "{{ '.name' | eval }} node {{arguments.foo}}:{{arguments.bar}}"
                }
            }
        ),
        file="missing.tf",
        contents='resource "null_resource" "null" {\n}\n',
    )
    # manual:
    terraform.set_operation(_terraform_execute)
    terraform._Executable_default_inputs = dict(foo="hello") # type: ignore[attr-defined] 
    return terraform


configurator_artifacts: Node = unfurl.nodes.LocalRepository(
    "configurator-artifacts",
)
configurator_artifacts.terraform = _make_terraform()  # type: ignore[attr-defined]


@operation(name="configure")
def test_configure(self, **kw):
    return self.find_artifact("terraform").execute()


test: Node = tosca.nodes.Root(
    "test",
)
test.set_operation(test_configure, "configure")

