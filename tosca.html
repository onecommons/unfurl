<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TOSCA &mdash; Unfurl Documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="_static/favicon32.png"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/custom.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="A TOSCA Python-based DSL" href="dsl.html" />
    <link rel="prev" title="Managing Secrets" href="secrets.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/unfurl_logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="get-started-step-by-step.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="ensembles.html">Ensembles</a></li>
<li class="toctree-l1"><a class="reference internal" href="projects.html">Unfurl Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="secrets.html">Managing Secrets</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">TOSCA</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#core-tosca-concepts">Core TOSCA Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#service-template">Service Template</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#entity-types">Entity Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#topology-template">Topology Template</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#node-template">Node Template</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id4">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#relationship-template">Relationship Template</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id5">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#complete-example">Complete Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dsl.html">Python alternative to YAML</a></li>
<li class="toctree-l1"><a class="reference internal" href="jobs.html">Jobs and Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="runtime.html">Runtime Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="configurators.html">Configurators</a></li>
<li class="toctree-l1"><a class="reference internal" href="configurators.html#installers">Installers</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing.html">Template Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="expressions.html">Expression Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line</a></li>
<li class="toctree-l1"><a class="reference internal" href="jsonschema.html">Configuration Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="toscaref.html">TOSCA Language Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">Changelog for Unfurl</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Unfurl</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">TOSCA</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/tosca.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tosca">
<span id="id1"></span><h1><a class="toc-backref" href="#id6">TOSCA</a><a class="headerlink" href="#tosca" title="Permalink to this headline"></a></h1>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#tosca" id="id6">TOSCA</a></p>
<ul>
<li><p><a class="reference internal" href="#introduction" id="id7">Introduction</a></p></li>
<li><p><a class="reference internal" href="#core-tosca-concepts" id="id8">Core TOSCA Concepts</a></p></li>
<li><p><a class="reference internal" href="#service-template" id="id9">Service Template</a></p>
<ul>
<li><p><a class="reference internal" href="#example" id="id10">Example</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#entity-types" id="id11">Entity Types</a></p>
<ul>
<li><p><a class="reference internal" href="#id2" id="id12">Example</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#topology-template" id="id13">Topology Template</a></p>
<ul>
<li><p><a class="reference internal" href="#id3" id="id14">Example</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#node-template" id="id15">Node Template</a></p>
<ul>
<li><p><a class="reference internal" href="#id4" id="id16">Example</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#relationship-template" id="id17">Relationship Template</a></p>
<ul>
<li><p><a class="reference internal" href="#id5" id="id18">Example</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#complete-example" id="id19">Complete Example</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="introduction">
<h2><a class="toc-backref" href="#id7">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline"></a></h2>
<p>The Topology and Orchestration Specification for Cloud Applications (TOSCA) is an <a class="reference external" href="https://www.oasis-open.org/committees/tc_home.php?wg_abbrev=tosca">OASIS open standard</a> that provides language to describe a topology of cloud based web services, their components, relationships, and the processes that manage them. TOSCA provides mechanisms for abstraction and composition, thereby enabling portability and automated management across cloud providers regardless of underlying platform or infrastructure.</p>
<p>The TOSCA specification allows the user to define a <a class="reference internal" href="#service-template"><span class="std std-ref">Service Template</span></a> which describes an online application or service and how to deploy it. In order to successfully author a TOSCA service template, it is important to understand the various components used within the TOSCA specification and how are they interlinked:</p>
<ul class="simple">
<li><p><em>Node templates</em> describe the resources that will be instantiated when the service template is deployed. They are linked to other nodes through relationships.</p></li>
<li><p><em>Relationship templates</em> can be used to provide additional information about those relationships, for example how to establish a connection between two nodes.</p></li>
<li><p><em>Interfaces</em> that define operations on nodes that are invoked by a TOSCA orchestrator like Unfurl. TOSCA defines a standard interface for lifecycle management (deploying, starting, stopping and destroying resources) and the user can define additional interfaces for “Day Two” operations, such as maintainence tasks.</p></li>
<li><p><em>Artifacts</em> such as container images, software packages, or files that need to be deployed or used as an implementation for an operation.</p></li>
<li><p><em>Policies</em> which define a condition or a set of actions for a Node. The orchestrator evaluates the conditions within the Policy against events that trigger. The required actions are then performed against the corresponding Interfaces.</p></li>
<li><p><em>Workflows</em> allows you to define a set of manually defined tasks to run in a sequential order.</p></li>
<li><p><em>Type definitons</em> TOSCA provides an object-oriented type system that lets you declare types for all of the above components as well as custom data types.</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>For more information, see the full <a class="reference internal" href="toscaref.html#tosca-language-reference"><span class="std std-ref">TOSCA Language Reference</span></a>.</p>
</div>
</section>
<section id="core-tosca-concepts">
<h2><a class="toc-backref" href="#id8">Core TOSCA Concepts</a><a class="headerlink" href="#core-tosca-concepts" title="Permalink to this headline"></a></h2>
<p>The figure below illustrates the core components of a TOSCA service template.
At the heart of a TOSCA service template is a <a class="reference internal" href="toscaref/spec-topology-template.html#topology-template"><span class="std std-ref">Topology Template</span></a> that describes a model of the service’s online resources, including how they connect together and how they should be deployed. These resources are represented by a <a class="reference internal" href="#node-template"><span class="std std-ref">Node Template</span></a>.
The Node Template and a Relationship Template are the building blocks of any TOSCA Specification.</p>
<a class="reference internal image-reference" href="_images/service_template.svg"><img alt="_images/service_template.svg" class="align-center" src="_images/service_template.svg" width="90%" /></a>
</section>
<section id="service-template">
<h2><a class="toc-backref" href="#id9">Service Template</a><a class="headerlink" href="#service-template" title="Permalink to this headline"></a></h2>
<p>A TOSCA service template contains all the information needed to deploy the service it describes. In Unfurl, a service template can be a stand-alone YAML file that is included in the <a class="reference internal" href="jsonschema.html#id2"><span class="std std-ref">ensemble.yaml</span></a> configuration file or embedded directly in that file as a child of the <a class="reference external" href="_static/TOSCA-Simple-Profile-YAML-v1.3-os-toc.html#DEFN_ELEMENT_SERVICE_TEMPLATE">Service templates</a> element.</p>
<p>A service template has the following sections:</p>
<ul class="simple">
<li><p><a class="reference internal" href="toscaref/spec-tosca_def_version.html"><span class="doc">Metadata</span></a> sections, which includes the <code class="docutils literal notranslate"><span class="pre">tosca_definitions_version</span></code>, <code class="docutils literal notranslate"><span class="pre">description</span></code>, <code class="docutils literal notranslate"><span class="pre">metadata</span></code>, <code class="docutils literal notranslate"><span class="pre">dsl_definitions</span></code></p></li>
<li><p><a class="reference internal" href="toscaref/spec-imports.html#imports"><span class="std std-ref">Imports</span></a> and <a class="reference internal" href="toscaref/spec-repositories.html#repositories"><span class="std std-ref">Repositories</span></a> sections</p></li>
<li><p>Types sections that contain types of Node, Relationships, Capabilities, Artifacts, Interfaces, Policy and Groups</p></li>
<li><p>Topology Template which include sections for <a class="reference internal" href="toscaref/spec-inputs.html#inputs"><span class="std std-ref">Inputs</span></a>, <code class="docutils literal notranslate"><span class="pre">outputs</span></code>, Node and relationship templates, <a class="reference internal" href="toscaref/spec-substitution-mapping.html#substitution-mapping"><span class="std std-ref">substitution_mappings</span></a>, <a class="reference internal" href="toscaref/spec-groups.html#groups"><span class="std std-ref">Groups</span></a>, <a class="reference internal" href="toscaref/spec-policy.html#policy"><span class="std std-ref">policies</span></a> and <a class="reference internal" href="toscaref/spec-imperative-workflow.html#workflows"><span class="std std-ref">Workflows</span></a>.</p></li>
</ul>
<section id="example">
<h3><a class="toc-backref" href="#id10">Example</a><a class="headerlink" href="#example" title="Permalink to this headline"></a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">tosca_definitions_version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca_simple_unfurl_1_0_0</span><span class="w"> </span><span class="c1"># or use the standard tosca_simple_yaml_1_3</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">An illustrative TOSCA service template</span>
<span class="nt">metadata</span><span class="p">:</span><span class="w"> </span><span class="c1"># the following metadata keys are defined in the TOSCA specification:</span>
<span class="w">  </span><span class="nt">template_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hello world</span>
<span class="w">  </span><span class="nt">template_author</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">onecommons</span>
<span class="w">  </span><span class="nt">template_version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0.0</span>

<span class="nt">repositories</span><span class="p">:</span>
<span class="w">   </span><span class="nt">tosca-community-contributions</span><span class="p">:</span>
<span class="w">     </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/oasis-open/tosca-community-contributions.git</span>

<span class="w">   </span><span class="nt">docker_hub</span><span class="p">:</span>
<span class="w">     </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://registry.hub.docker.com/</span>
<span class="w">     </span><span class="nt">credential</span><span class="p">:</span>
<span class="w">         </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">user1</span>
<span class="w">         </span><span class="nt">token</span><span class="p">:</span>
<span class="w">           </span><span class="nt">eval</span><span class="p">:</span><span class="w"> </span><span class="c1"># eval is an Unfurl extension</span>
<span class="w">             </span><span class="nt">secret</span><span class="p">:</span>
<span class="w">               </span><span class="l l-Scalar l-Scalar-Plain">dockerhub_user1_pw</span>

<span class="w w-Error"> </span><span class="nt">imports</span><span class="p">:</span>

<span class="w"> </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-shared-types.yaml</span>
<span class="w">   </span><span class="nt">namespace_prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">base</span><span class="w"> </span><span class="c1"># optional</span>
<span class="w"> </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">profiles/orchestration/1.0/profile.yaml</span>
<span class="w">   </span><span class="nt">repository</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca-community-contributions</span>

<span class="nt">node_types</span><span class="p">:</span>
<span class="w">   </span><span class="c1"># ... see the &quot;entity types” section below</span>

<span class="nt">topology_template</span><span class="p">:</span>
<span class="w">   </span><span class="c1"># ... see the “topology_templates” section below</span>
<span class="w">   </span><span class="nt">node_templates</span><span class="p">:</span>
<span class="w">   </span><span class="c1"># ... see the node_templates section below</span>
<span class="w">   </span><span class="nt">relationship_templates</span><span class="p">:</span>
<span class="w">   </span><span class="c1"># ... see the relationship_templates section below</span>
</pre></div>
</div>
</section>
</section>
<section id="entity-types">
<h2><a class="toc-backref" href="#id11">Entity Types</a><a class="headerlink" href="#entity-types" title="Permalink to this headline"></a></h2>
<p>Every entity in TOSCA (including Nodes, Relationships, Artifacts and Data) has a declared type and custom type hierarchies can be defined in the <a class="reference internal" href="#service-template"><span class="std std-ref">Service Template</span></a>.
Types declare the required properties, default definitions, and interface operations for an entity. Each type of entity has can have its own section in the service template, for example, <code class="docutils literal notranslate"><span class="pre">node_types</span></code>, <code class="docutils literal notranslate"><span class="pre">relationship_types</span></code>, <code class="docutils literal notranslate"><span class="pre">data_types</span></code>,``artifact_types``, <code class="docutils literal notranslate"><span class="pre">interface_types</span></code>, etc.</p>
<section id="id2">
<h3><a class="toc-backref" href="#id12">Example</a><a class="headerlink" href="#id2" title="Permalink to this headline"></a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">node_types</span><span class="p">:</span>
<span class="w">     </span><span class="nt">myApplication</span><span class="p">:</span>
<span class="w">       </span><span class="nt">derived_from</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca.nodes.SoftwareComponent</span>
<span class="w">       </span><span class="nt">attributes</span><span class="p">:</span>
<span class="w">         </span><span class="nt">private_address</span><span class="p">:</span>
<span class="w">           </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">       </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">        </span><span class="nt">domain</span><span class="p">:</span>
<span class="w">         </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">         </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt"> get_input</span><span class="p">:</span><span class="w"> </span><span class="nv">domain</span><span class="w"> </span><span class="p p-Indicator">}</span>
<span class="w">         </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">           </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca.datatypes.network.PortSpec</span>
<span class="w">       </span><span class="nt">requirements</span><span class="p">:</span>
<span class="w">         </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span>
<span class="w">             </span><span class="nt">capabilities</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca.capabilities.Compute</span>
<span class="w">             </span><span class="nt">relationship</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca.relationships.HostedOn</span>
<span class="w">         </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">db</span><span class="p">:</span>
<span class="w">             </span><span class="nt">capabilities</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">base:capabilities.postgresdb</span>
<span class="w">             </span><span class="nt">relationship</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca.relationships.ConnectsTo</span>
<span class="w">       </span><span class="nt">interfaces</span><span class="p">:</span>
<span class="w">         </span><span class="c1"># TOSCA defines Standard interface for lifecycle management but you can define your own too</span>
<span class="w">         </span><span class="nt">Standard</span><span class="p">:</span>
<span class="w">           </span><span class="nt">create</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">create.sh</span>
<span class="w">           </span><span class="nt">configure</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">configure.sh</span>
<span class="w">           </span><span class="nt">delete</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">delete.sh</span>
</pre></div>
</div>
</section>
</section>
<section id="topology-template">
<h2><a class="toc-backref" href="#id13">Topology Template</a><a class="headerlink" href="#topology-template" title="Permalink to this headline"></a></h2>
<p>Topology Template refers to the topology model of a service. This model consists of node template and relationship template that are linked together to translate and structure the application.</p>
<section id="id3">
<h3><a class="toc-backref" href="#id14">Example</a><a class="headerlink" href="#id3" title="Permalink to this headline"></a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">topology_template</span><span class="p">:</span>

<span class="w">  </span><span class="nt">inputs</span><span class="p">:</span>
<span class="w">    </span><span class="nt">domain</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>

<span class="w">  </span><span class="nt">outputs</span><span class="p">:</span>
<span class="w">    </span><span class="nt">url</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt"> concat</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">https</span><span class="p p-Indicator">:</span><span class="nv">//</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt"> get_input</span><span class="p">:</span><span class="w"> </span><span class="nv">domain</span><span class="w"> </span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;:&#39;</span><span class="p p-Indicator">,</span><span class="w">  </span><span class="p p-Indicator">{</span><span class="nt"> get_attribute</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">myapp</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">portspec</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">source</span><span class="w"> </span><span class="p p-Indicator">]</span><span class="w"> </span><span class="p p-Indicator">},</span><span class="w"> </span><span class="s">&#39;/api/events&#39;</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="p p-Indicator">}</span>
<span class="w">      </span><span class="c1"># Unfurl also support ansible-enhanced jinja2 template so you could write this instead:</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://{{ TOPOLOGY.inputs.domain }}:{{ NODES.myApp.portspec.source }}/api/events</span>
</pre></div>
</div>
</section>
</section>
<section id="node-template">
<h2><a class="toc-backref" href="#id15">Node Template</a><a class="headerlink" href="#node-template" title="Permalink to this headline"></a></h2>
<p>A Node Template defines an instance or a component of the application in the service template. Where a node type refers to the class or family of component at a high level that your resource belongs to, a node template makes use of the components defined in the node type and customizes the predefined properties and operations based upon the use case.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>To know more about these terminologies, refer to the <a class="reference internal" href="glossary.html#glossary"><span class="std std-ref">Glossary</span></a> section.</p>
</div>
<section id="id4">
<h3><a class="toc-backref" href="#id16">Example</a><a class="headerlink" href="#id4" title="Permalink to this headline"></a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">node_templates</span><span class="p">:</span>

<span class="w">  </span><span class="nt">myApp</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myApplication</span>
<span class="w">    </span><span class="nt">artifacts</span><span class="p">:</span>
<span class="w">      </span><span class="nt">image</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tosca.artifacts.Deployment.Image.Container.Docker</span>
<span class="w">        </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp:latest</span>
<span class="w">        </span><span class="nt">repository</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker_hub</span>
<span class="w">    </span><span class="nt">requirements</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">compute</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">db</span><span class="p">:</span>
<span class="w">          </span><span class="nt">node</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mydb</span>
<span class="w">          </span><span class="nt">relationship</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mydb_connection</span>

<span class="w">  </span><span class="nt">mydb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">base:postgresdb</span>
<span class="w">    </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">       </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mydb</span>

<span class="w">  </span><span class="nt">compute</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unfurl.nodes.Compute</span>
<span class="w">    </span><span class="nt">capabilities</span><span class="p">:</span>
<span class="w">      </span><span class="nt">host</span><span class="p">:</span>
<span class="w">        </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">          </span><span class="nt">num_cpus</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">          </span><span class="nt">disk_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">200GB</span>
<span class="w">          </span><span class="nt">mem_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">512MB</span>
</pre></div>
</div>
</section>
</section>
<section id="relationship-template">
<h2><a class="toc-backref" href="#id17">Relationship Template</a><a class="headerlink" href="#relationship-template" title="Permalink to this headline"></a></h2>
<p>A Relationship Template specifies the relationship between the components defined in the node templates and how the various nodes are connected to each other. Apart from the connections, relationship templates also include information regarding the dependencies and the order of the deployment that should be followed to instantiate a service template.</p>
<p>An important thing to notice here is, in a relationship, it is important for the node requirements of a component to match the capabilities of the node it is being linked to.</p>
<section id="id5">
<h3><a class="toc-backref" href="#id18">Example</a><a class="headerlink" href="#id5" title="Permalink to this headline"></a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">relationship_templates</span><span class="p">:</span>
<span class="w">  </span><span class="nt">mydb_connection</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">base:relationships.dbconnection</span>
<span class="w">    </span><span class="nt">properties</span><span class="p">:</span>
<span class="w">      </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp</span>
<span class="w">      </span><span class="nt">password</span><span class="p">:</span>
<span class="w">        </span><span class="nt">eval</span><span class="p">:</span>
<span class="w">          </span><span class="nt">secret</span><span class="p">:</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">myapp_db_pw</span>
</pre></div>
</div>
</section>
</section>
<section id="complete-example">
<h2><a class="toc-backref" href="#id19">Complete Example</a><a class="headerlink" href="#complete-example" title="Permalink to this headline"></a></h2>
<p>Combining the above examples into one file, we have a complete service template:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tosca_definitions_version</span><span class="p">:</span> <span class="n">tosca_simple_unfurl_1_0_0</span> <span class="c1"># or use the standard tosca_simple_yaml_1_3</span>
<span class="n">description</span><span class="p">:</span> <span class="n">An</span> <span class="n">illustrative</span> <span class="n">TOSCA</span> <span class="n">service</span> <span class="n">template</span>
<span class="n">metadata</span><span class="p">:</span> <span class="c1"># the following metadata keys are defined in the TOSCA specification:</span>
  <span class="n">template_name</span><span class="p">:</span> <span class="n">hello</span> <span class="n">world</span>
  <span class="n">template_author</span><span class="p">:</span> <span class="n">onecommons</span>
  <span class="n">template_version</span><span class="p">:</span> <span class="mf">1.0.0</span>

<span class="n">repositories</span><span class="p">:</span>
  <span class="n">tosca</span><span class="o">-</span><span class="n">community</span><span class="o">-</span><span class="n">contributions</span><span class="p">:</span>
    <span class="n">url</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">oasis</span><span class="o">-</span><span class="nb">open</span><span class="o">/</span><span class="n">tosca</span><span class="o">-</span><span class="n">community</span><span class="o">-</span><span class="n">contributions</span><span class="o">.</span><span class="n">git</span>

  <span class="n">docker_hub</span><span class="p">:</span>
    <span class="n">url</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">registry</span><span class="o">.</span><span class="n">hub</span><span class="o">.</span><span class="n">docker</span><span class="o">.</span><span class="n">com</span><span class="o">/</span>
    <span class="n">credential</span><span class="p">:</span>
        <span class="n">user</span><span class="p">:</span> <span class="n">user1</span>
        <span class="n">token</span><span class="p">:</span>
          <span class="nb">eval</span><span class="p">:</span> <span class="c1"># eval is an Unfurl extension</span>
            <span class="n">secret</span><span class="p">:</span>
              <span class="n">dockerhub_user1_pw</span>

<span class="n">imports</span><span class="p">:</span>

<span class="o">-</span> <span class="n">file</span><span class="p">:</span> <span class="n">my</span><span class="o">-</span><span class="n">shared</span><span class="o">-</span><span class="n">types</span><span class="o">.</span><span class="n">yaml</span>
  <span class="n">namespace_prefix</span><span class="p">:</span> <span class="n">base</span> <span class="c1"># optional</span>
<span class="o">-</span> <span class="n">file</span><span class="p">:</span> <span class="n">profiles</span><span class="o">/</span><span class="n">orchestration</span><span class="o">/</span><span class="mf">1.0</span><span class="o">/</span><span class="n">profile</span><span class="o">.</span><span class="n">yaml</span>
  <span class="n">repository</span><span class="p">:</span> <span class="n">tosca</span><span class="o">-</span><span class="n">community</span><span class="o">-</span><span class="n">contributions</span>

<span class="n">node_types</span><span class="p">:</span>
      <span class="n">myApplication</span><span class="p">:</span>
        <span class="n">derived_from</span><span class="p">:</span> <span class="n">tosca</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">SoftwareComponent</span>
        <span class="n">attributes</span><span class="p">:</span>
          <span class="n">private_address</span><span class="p">:</span>
            <span class="nb">type</span><span class="p">:</span> <span class="n">string</span>
        <span class="n">properties</span><span class="p">:</span>
         <span class="n">domain</span><span class="p">:</span>
          <span class="nb">type</span><span class="p">:</span> <span class="n">string</span>
          <span class="n">default</span><span class="p">:</span> <span class="p">{</span> <span class="n">get_input</span><span class="p">:</span> <span class="n">domain</span> <span class="p">}</span>
          <span class="n">ports</span><span class="p">:</span>
            <span class="nb">type</span><span class="p">:</span> <span class="n">tosca</span><span class="o">.</span><span class="n">datatypes</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">PortSpec</span>
        <span class="n">requirements</span><span class="p">:</span>
          <span class="o">-</span> <span class="n">host</span><span class="p">:</span>
              <span class="n">capabilities</span><span class="p">:</span> <span class="n">tosca</span><span class="o">.</span><span class="n">capabilities</span><span class="o">.</span><span class="n">Compute</span>
              <span class="n">relationship</span><span class="p">:</span> <span class="n">tosca</span><span class="o">.</span><span class="n">relationships</span><span class="o">.</span><span class="n">HostedOn</span>
          <span class="o">-</span> <span class="n">db</span><span class="p">:</span>
              <span class="n">capabilities</span><span class="p">:</span> <span class="n">base</span><span class="p">:</span><span class="n">capabilities</span><span class="o">.</span><span class="n">postgresdb</span>
              <span class="n">relationship</span><span class="p">:</span> <span class="n">tosca</span><span class="o">.</span><span class="n">relationships</span><span class="o">.</span><span class="n">ConnectsTo</span>
        <span class="n">interfaces</span><span class="p">:</span>
          <span class="c1"># TOSCA defines Standard interface for lifecycle management but you can define your own too</span>
          <span class="n">Standard</span><span class="p">:</span>
            <span class="n">create</span><span class="p">:</span> <span class="n">create</span><span class="o">.</span><span class="n">sh</span>
            <span class="n">configure</span><span class="p">:</span> <span class="n">configure</span><span class="o">.</span><span class="n">sh</span>
            <span class="n">delete</span><span class="p">:</span> <span class="n">delete</span><span class="o">.</span><span class="n">sh</span>

<span class="n">topology_template</span><span class="p">:</span>

  <span class="n">inputs</span><span class="p">:</span>
    <span class="n">domain</span><span class="p">:</span>
      <span class="nb">type</span><span class="p">:</span> <span class="n">string</span>

  <span class="n">outputs</span><span class="p">:</span>
    <span class="n">url</span><span class="p">:</span>
      <span class="nb">type</span><span class="p">:</span> <span class="n">string</span>
      <span class="n">value</span><span class="p">:</span> <span class="p">{</span> <span class="n">concat</span><span class="p">:</span> <span class="p">[</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="p">,</span> <span class="p">{</span> <span class="n">get_input</span><span class="p">:</span> <span class="n">domain</span> <span class="p">},</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span>  <span class="p">{</span> <span class="n">get_attribute</span><span class="p">:</span> <span class="p">[</span> <span class="n">myapp</span><span class="p">,</span> <span class="n">portspec</span><span class="p">,</span> <span class="n">source</span> <span class="p">]</span> <span class="p">},</span> <span class="s1">&#39;/api/events&#39;</span><span class="p">]</span> <span class="p">}</span>
      <span class="c1"># Unfurl also support ansible-enhanced jinja2 template so you could write this instead:</span>
      <span class="c1"># value: https://{{ TOPOLOGY.inputs.domain }}:{{ NODES.myApp.portspec.source }}/api/events</span>

  <span class="n">node_templates</span><span class="p">:</span>

    <span class="n">myApp</span><span class="p">:</span>
      <span class="nb">type</span><span class="p">:</span> <span class="n">myApplication</span>
      <span class="n">artifacts</span><span class="p">:</span>
        <span class="n">image</span><span class="p">:</span>
          <span class="nb">type</span><span class="p">:</span> <span class="n">tosca</span><span class="o">.</span><span class="n">artifacts</span><span class="o">.</span><span class="n">Deployment</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">Docker</span>
          <span class="n">file</span><span class="p">:</span> <span class="n">myapp</span><span class="p">:</span><span class="n">latest</span>
          <span class="n">repository</span><span class="p">:</span> <span class="n">docker_hub</span>
      <span class="n">requirements</span><span class="p">:</span>
        <span class="o">-</span> <span class="n">host</span><span class="p">:</span> <span class="n">compute</span>
        <span class="o">-</span> <span class="n">db</span><span class="p">:</span>
            <span class="n">node</span><span class="p">:</span> <span class="n">mydb</span>
            <span class="n">relationship</span><span class="p">:</span> <span class="n">mydb_connection</span>

    <span class="n">mydb</span><span class="p">:</span>
      <span class="nb">type</span><span class="p">:</span> <span class="n">base</span><span class="p">:</span><span class="n">postgresdb</span>
      <span class="n">properties</span><span class="p">:</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">mydb</span>

    <span class="n">compute</span><span class="p">:</span>
      <span class="nb">type</span><span class="p">:</span> <span class="n">unfurl</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">Compute</span>
      <span class="n">capabilities</span><span class="p">:</span>
        <span class="n">host</span><span class="p">:</span>
          <span class="n">properties</span><span class="p">:</span>
            <span class="n">num_cpus</span><span class="p">:</span> <span class="mi">1</span>
            <span class="n">disk_size</span><span class="p">:</span> <span class="mi">200</span><span class="n">GB</span>
            <span class="n">mem_size</span><span class="p">:</span> <span class="mi">512</span><span class="n">MB</span>

<span class="n">relationship_templates</span><span class="p">:</span>
  <span class="n">mydb_connection</span><span class="p">:</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">base</span><span class="p">:</span><span class="n">relationships</span><span class="o">.</span><span class="n">dbconnection</span>
    <span class="n">properties</span><span class="p">:</span>
      <span class="n">username</span><span class="p">:</span> <span class="n">myapp</span>
      <span class="n">password</span><span class="p">:</span>
        <span class="nb">eval</span><span class="p">:</span>
          <span class="n">secret</span><span class="p">:</span>
            <span class="n">myapp_db_pw</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="secrets.html" class="btn btn-neutral float-left" title="Managing Secrets" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="dsl.html" class="btn btn-neutral float-right" title="A TOSCA Python-based DSL" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, OneCommons Co..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>